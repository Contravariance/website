{"version":3,"file":"shikwasa.min.js","sources":["../src/templates/Player.js","../src/templates/Icon.js","../src/config.js","../src/utils.js","../src/focus-visible.js","../src/ui.js","../src/events.js","../src/player.js","../src/main.js"],"sourcesContent":["const PlayerTemplate = /* template */`\n  <div class=\"shk-player\">\n    <div class=\"shk-bar_wrap\">\n      <div class=\"shk-bar\" aria-label=\"progress bar\">\n        <div class=\"shk-bar_loaded\"\n          role=\"progressbar\"\n          aria-label=\"loaded progress\"\n          aria-valuenow=\"0\"\n          aria-valuemin=\"0\"\n          aria-valuemax=\"1\"></div>\n        <div class=\"shk-bar_played\"\n          role=\"progressbar\"\n          aria-label=\"played progress\"\n          aria-valuenow=\"0\"\n          aria-valuemin=\"0\"\n          aria-valuemax=\"1\">\n          <button class=\"shk-bar-handle\"\n            role=\"slider\"\n            aria-label=\"seek progress\"\n            aria-valuenow=\"0\"\n            aria-valuemin=\"0\"\n            aria-orientation=\"horizontal\"\n            aria-valuemax=\"1\"></button>\n        </div>\n      </div>\n    </div>\n    <div class=\"shk-body\">\n      <div class=\"shk-cover\">\n        <div class=\"shk-img\"></div>\n      </div>\n      <div class=\"shk-main\">\n        <div class=\"shk-text\">\n          <div class=\"shk-artist_wrap\">\n            <span class=\"shk-artist\"></span>\n          </div>\n          <div class=\"shk-title_wrap\">\n            <div class=\"shk-title_inner\">\n              <span class=\"shk-title\"></span>\n            </div>\n          </div>\n        </div>\n        <div class=\"shk-controls\">\n          <div class=\"shk-controls_basic\">\n            <button class=\"shk-btn shk-btn_speed\"\n              aria-label=\"toggle playback rate\"\n              title=\"change playback rate\"\n              aria-live=\"polite\">1.0x</button>\n            <button class=\"shk-btn shk-btn_backward\"\n              aria-label=\"rewind 10 seconds\"\n              title=\"rewind 10 seconds\">\n              <svg aria-hidden=\"true\">\n                <use xlink:href=\"#shk-icon_backward\" />\n              </svg>\n            </button>\n            <button class=\"shk-btn shk-btn_toggle\" aria-label=\"toggle play and pause\">\n              <svg class=\"shk-btn_play\" aria-hidden=\"true\">\n                <use xlink:href=\"#shk-icon_play\" />\n              </svg>\n              <svg class=\"shk-btn_pause\" aria-hidden=\"true\">\n                <use xlink:href=\"#shk-icon_pause\" />\n              </svg>\n            </button>\n            <button class=\"shk-btn shk-btn_forward\" aria-label=\"forward 10 seconds\" title=\"forward 10 seconds\">\n              <svg aria-hidden=\"true\">\n                <use xlink:href=\"#shk-icon_forward\" />\n              </svg>\n            </button>\n            <button class=\"shk-btn shk-btn_more\" aria-label=\"more controls\" title=\"more controls\">\n              <svg aria-hidden=\"true\">\n                <use xlink:href=\"#shk-icon_more\" />\n              </svg>\n            </button>\n          </div>\n          <div class=\"shk-controls_extra\">\n            <button class=\"shk-btn shk-btn_volume\" aria-label=\"toggle volume\" title=\"volume\">\n              <svg class=\"shk-btn_unmute\" aria-hidden=\"true\">\n                <use xlink:href=\"#shk-icon_unmute\" />\n              </svg>\n              <svg class=\"shk-btn_mute\" aria-hidden=\"true\">\n                <use xlink:href=\"#shk-icon_mute\" />\n              </svg>\n            </button>\n          </div>\n        </div>\n        <div class=\"shk-display\">\n          <span class=\"shk-loader\" aria-live=\"polite\">\n            <span class=\"shk-visuallyhidden\" tabindex=\"-1\">loading</span>\n            <svg aria-hidden=\"true\" aria-label=\"loading\" aria-live=\"polite\" viewbox=\"0 0 66 66\">\n              <circle cx=\"33\" cy=\"33\" r=\"30\" fill=\"transparent\" stroke=\"url(#shk-gradient)\" stroke-dasharray=\"170\"\n                stroke-dashoffset=\"20\" stroke-width=\"6\" />\n              <lineargradient id=\"shk-gradient\">\n                <stop offset=\"50%\" stop-color=\"currentColor\" />\n                <stop offset=\"65%\" stop-color=\"currentColor\" stop-opacity=\".5\" />\n                <stop offset=\"100%\" stop-color=\"currentColor\" stop-opacity=\"0\" />\n              </lineargradient>\n            </svg>\n          </span>\n          <span class=\"shk-time\">\n            <span class=\"shk-time_now\">00:00</span><span class=\"shk-time_duration\">00:00</span>\n          </span>\n        </div>\n      </div>\n    </div>\n  </div>\n`\nexport default PlayerTemplate\n","const IconTemplate = /* template */`\n  <svg class=\"shk-icons\" xmlns=\"http://www.w3.org/2000/svg\">\n    <symbol id=\"shk-icon_play\" viewbox=\"0 0 64 64\">\n      <path\n        d=\"M32 0a32 32 0 1 1 0 64 32 32 0 0 1 0-64zm-9 17.8c-1 0-1.7.6-1.7 1.4v25.6c0 .8.8 1.4 1.7 1.4 0 0 25-12 26.2-13.1 1-1 .3-1.9.1-2.1z\" />\n    </symbol>\n\n    <symbol id=\"shk-icon_pause\" viewbox=\"0 0 64 64\">\n      <path fill-rule=\"nonzero\"\n        d=\"M32 0a32 32 0 1 0 0 64 32 32 0 0 0 0-64zm-4 40a2 2 0 0 1-2 2h-4a2 2 0 0 1-2-2V24c0-1.1.9-2 2-2h4a2 2 0 0 1 2 2v16zm16 0a2 2 0 0 1-2 2h-4a2 2 0 0 1-2-2V24c0-1.1.9-2 2-2h4a2 2 0 0 1 2 2v16z\" />\n    </symbol>\n\n    <symbol id=\"shk-icon_download\" viewbox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\">\n      <path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3\" />\n    </symbol>\n\n    <symbol id=\"shk-icon_forward\" viewbox=\"0 0 128 139\">\n      <path\n        d=\"M64 11v14h-.8A50 50 0 1 0 114 75h14a64 64 0 1 1-64-64zm16.9 35c6.6 0 11.8 2.7 15.6 8.3a38 38 0 0 1 5.3 21.4c0 9-1.8 16-5.3 21.3-3.8 5.6-9 8.4-15.6 8.4-6.7 0-12-2.8-15.6-8.4A38 38 0 0 1 60 75.7c0-9 1.8-16.1 5.3-21.4C69 48.7 74.2 46 80.9 46zm-32.5 1v57.1H39V58.3a32.3 32.3 0 0 1-13 7V56a34 34 0 0 0 15.4-9h7zm32.5 7c-4.6 0-7.8 2.4-9.6 7.5-1.3 3.5-2 8.2-2 14.2 0 5.9.7 10.6 2 14.1 1.8 5 5 7.6 9.6 7.6 4.5 0 7.7-2.5 9.6-7.6 1.3-3.5 1.9-8.2 1.9-14.1 0-6-.6-10.7-2-14.2-1.8-5.1-5-7.6-9.5-7.6zM64 0l48 19-48 19V0z\" />\n    </symbol>\n\n    <symbol id=\"shk-icon_backward\" viewbox=\"0 0 128 139\">\n      <path\n        d=\"M64 0v11A64 64 0 1 1 0 75h14a50 50 0 1 0 50-50v13L16 19 64 0zm17 45.8c6.6 0 11.8 2.7 15.6 8.3a38 38 0 0 1 5.3 21.3c0 9-1.8 16.1-5.3 21.4a18 18 0 0 1-15.6 8.3c-6.7 0-12-2.8-15.6-8.3a38 38 0 0 1-5.3-21.4c0-9 1.8-16 5.3-21.3 3.7-5.6 8.9-8.3 15.6-8.3zm-32.4 1V104h-9.4V58.2a32.3 32.3 0 0 1-13 7v-9.4a34 34 0 0 0 15.4-9h7zm32.4 7c-4.6 0-7.8 2.5-9.6 7.6-1.3 3.4-2 8.1-2 14.1s.7 10.7 2 14.2c1.8 5 5 7.6 9.6 7.6 4.5 0 7.7-2.6 9.6-7.6 1.3-3.5 2-8.2 2-14.2s-.7-10.7-2-14.1c-2-5.1-5.1-7.6-9.6-7.6z\" />\n    </symbol>\n\n    <symbol id=\"shk-icon_more\" viewbox=\"0 0 64 64\">\n      <path\n        d=\"M8 24a8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8 8 8 0 0 0-8-8zm48 0a8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8 8 8 0 0 0-8-8zm-24 0a8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8 8 8 0 0 0-8-8zm0 0\" />\n    </symbol>\n\n    <symbol id=\"shk-icon_chapter\" viewbox=\"0 0 64 64\">\n      <path d=\"M60.8 55.3H18.1a3.2 3.2 0 1 1 0-6.4h42.8a3.2 3.2 0 0 1 3.1 4.9c-.7 1-1.9 1.6-3.1 1.5zm0-20.2H18.1a3.2 3.2 0 1 1 0-6.4h42.8a3.2 3.2 0 1 1 0 6.4zm0-20H18.1a3.2 3.2 0 1 1 0-6.3h42.8a3.2 3.2 0 0 1 0 6.3zM8.5 12.3a4.2 4.2 0 1 1-8.5 0 4.2 4.2 0 0 1 8.5 0zm0 19.8A4.2 4.2 0 1 1 0 32a4.2 4.2 0 0 1 8.5 0zm0 19.8a4.3 4.3 0 1 1-8.5 0 4.3 4.3 0 0 1 8.5 0zm0 0\"/>\n    </symbol>\n\n    <symbol id=\"shk-icon_unmute\" viewBox=\"0 0 64 66\">\n      <path d=\"M34.3 0c1.5.1 2.6 1.4 2.9 2.8v60.3c-.3 1.4-1.4 2.7-3 2.8-.7.1-1.6-.1-2.6-.7L13.7 50H4.2a4 4 0 0 1-4.1-4V20.6c0-2.2 1.8-4 4-4.1h9.6c.7-.8 17.2-15.1 17.9-15.8 1-.6 1.9-.8 2.6-.7zm6.4 9.3a2 2 0 0 1 2.4-1.6 25.8 25.8 0 0 1 0 50.5l-.4.1a2 2 0 1 1-.4-4.1 21.7 21.7 0 0 0 0-42.5 2 2 0 0 1-1.6-2.4zm4.7 12.8a12.1 12.1 0 0 1 0 21.8 2 2 0 0 1-2.8-1c-.5-1-.1-2.2 1-2.8a8 8 0 0 0 0-14.4 2 2 0 0 1-1-2.7 2 2 0 0 1 2.8-.9zm0 0\"/>\n    </symbol>\n\n    <symbol id=\"shk-icon_mute\" viewBox=\"0 0 64 64\">\n      <path d=\"M33.2 0c-.8 0-1.6.1-2.6.7l-17.4 15H4a4 4 0 0 0-4 4v24.1a4 4 0 0 0 4 4h9.2l17.4 14.5c1 .6 1.8.8 2.6.7 1.4-.1 2.5-1.4 2.8-2.6V2.7C35.7 1.4 34.6 0 33.2 0zm23.2 31.5l6.9-6.8c.7-.6 1-1.5.7-2.4-.2-.8-.9-1.5-1.8-1.7-.8-.2-1.8 0-2.4.7L53 28.1 46 21.3c-.6-.6-1.5-1-2.4-.7-.9.2-1.5.9-1.8 1.7-.2.9.1 1.8.8 2.4l6.9 6.8-7 6.8c-.8 1-.8 2.4.2 3.3.9 1 2.4 1 3.3.1l7-6.8 6.8 6.8c1 .9 2.5.8 3.4 0 1-1 1-2.4 0-3.4l-6.8-6.8zm0 0\"/>\n    </symbol>\n\n    <symbol id=\"shk-icon_triangle\" viewbox=\"0 0 64 64\"><path d=\"M59 29.2L7.8.4A3.2 3.2 0 003 3.2v57.6a3.2 3.2 0 004.8 2.8L59 34.8a3.2 3.2 0 000-5.6z\" /></symbol>\n    <symbol id=\"shk-icon_chart\" viewbox=\"0 0 64 64\"><g transform=\"matrix(1 0 0 -1 0 64)\"><rect x=\"10\" width=\"8\" height=\"54.1\" rx=\"3\"><animate attributeName=\"height\" begin=\"0s\" dur=\"2s\" values=\"64;55;33;5;60;23;58;33;12;14;52;64\" calcMode=\"linear\" repeatCount=\"indefinite\"/></rect><rect x=\"26\" width=\"8\" height=\"32.8\" rx=\"3\"><animate attributeName=\"height\" begin=\"0s\" dur=\"2s\" values=\"50;34;64;23;56;23;34;4;64;54;21;50\" calcMode=\"linear\" repeatCount=\"indefinite\"/></rect><rect x=\"42\" width=\"8\" height=\"42.6\" rx=\"3\"><animate attributeName=\"height\" begin=\"0s\" dur=\"2s\" values=\"30;45;13;64;56;24;45;64;34;23;64;30\" calcMode=\"linear\" repeatCount=\"indefinite\"/></rect></g></symbol>\n    <symbol id=\"shk-icon_close\" viewbox=\"0 0 16 16\"><path d=\"M3.207 14.207a1 1 0 1 1-1.414-1.414l11-11a1 1 0 0 1 1.414 1.414zm11-1.414a1 1 0 0 1-1.414 1.414l-11-11a1 1 0 0 1 1.414-1.414z\"></path></symbol>\n  </svg>\n`\nexport default IconTemplate\n","export const DEFAULT = {\n  container: () => document.querySelector('body'),\n  parser: null,\n  fixed: {\n    type: 'auto',\n    position: 'bottom',\n  },\n  download: false,\n  themeColor: '#00869B',\n  theme: 'auto',\n  autoPlay: false,\n  muted: false,\n  preload: 'metadata',\n  speedOptions: [0.5, 0.75, 1, 1.25, 1.5],\n  audio: null,\n}\n\nexport const CONFIG = {\n  fixedOptions: ['auto', 'static', 'fixed'],\n  audioOptions: {\n    title: 'Unknown Title',\n    artist: 'Unknown Artist',\n    duration: NaN,\n    cover: null,\n    chapters: [],\n    src: null,\n    album: '',\n  },\n}\n","import { DEFAULT ,CONFIG } from './config'\n\nexport function secondToTime(time) {\n  time = Math.round(time)\n  let hour = Math.floor(time / 3600)\n  let min = Math.floor((time - hour * 3600) / 60)\n  let sec = Math.floor(time - hour * 3600 - min * 60)\n  min = min < 10 ? '0' + min : min\n  sec = sec < 10 ? '0' + sec : sec\n  if (hour === 0) {\n    return `${min}:${sec}`\n  }\n  hour = hour < 10 ? '0' + hour : hour\n  return `${hour}:${min}:${sec}`\n}\n\nexport function numToString(num) {\n  const float = parseFloat(num).toFixed(2)\n  return float.slice(-1) === '0' ? float.slice(0, -1) :float\n}\n\nexport function marquee(textWrap, textEl, speed = 60) {\n  const overflow = textEl.offsetWidth - textWrap.offsetWidth\n  if (overflow > 0) {\n    textWrap.setAttribute('data-overflow', '')\n    const duration = textEl.offsetWidth / speed\n    textWrap.style.animationDuration = `${duration}s`\n  } else {\n    textWrap.removeAttribute('data-overflow')\n  }\n}\n\nexport function handleOptions(options) {\n  const _options = Object.assign({}, options)\n  _options.audio = Object.assign({}, options.audio)\n  Object.keys(DEFAULT).forEach(k => {\n    _options[k] = (_options[k] || typeof _options[k] === 'boolean') ?\n      _options[k] : DEFAULT[k]\n  })\n  if (typeof _options.container === 'function') {\n    _options.container = _options.container()\n  }\n  const fixedType = CONFIG.fixedOptions.find(item => item === _options.fixed.type)\n  if (!fixedType) {\n    _options.fixed.type = DEFAULT.fixed.type\n  }\n  if (!Array.isArray(_options.speedOptions)) {\n    _options.speedOptions = [_options.speedOptions]\n  }\n  if (_options.speedOptions.indexOf(1) === -1) {\n    _options.speedOptions.push(1)\n  }\n  _options.speedOptions = _options.speedOptions\n    .map(sp => parseFloat(sp))\n    .filter(sp => !isNaN(sp))\n  if (_options.speedOptions.length > 1) {\n    _options.speedOptions.sort((a, b) => a - b)\n  }\n  return _options\n}\n\nexport function handleAudio(audio = {}, parsedData = {}) {\n  let audioData = Object.assign({}, audio)\n  Object.keys(CONFIG.audioOptions).forEach(k => {\n    audioData[k] = audioData[k] ||\n      parsedData[k] ||\n      CONFIG.audioOptions[k]\n  })\n  return audioData\n}\n\nexport async function parseAudio(audio = {}, parser = {}) {\n  const { tags } = await parserWrap(audio.src, parser) || {}\n  const tagData = handleParsedTags(tags)\n  return handleAudio(audio, tagData)\n}\n\nexport function parserWrap(src, parser) {\n  return new Promise((resolve, reject) => {\n    parser.read(src, {\n      onSuccess: resolve,\n      onError: reject,\n    })\n  })\n}\n\nexport function handleParsedTags(tags = {}) {\n  let cover, chapters, duration\n  const { title, artist } = tags\n  if (tags.picture && tags.picture.data && tags.picture.format) {\n    const byteArray = new Uint8Array(tags.picture.data)\n    const blob = new Blob([byteArray], { type: tags.picture.format })\n    cover = URL.createObjectURL(blob)\n  }\n  if (tags.TLEN && tags.TLEN.data) {\n    duration = +tags.TLEN.data / 1000\n  }\n  if (tags.CHAP && tags.CHAP.length) {\n    chapters = tags.CHAP\n      .filter(ch => ch.id === 'CHAP')\n      .map(ch => {\n        if (ch.data && ch.data.subFrames && ch.data.subFrames.TIT2) {\n          return {\n            id: ch.data.id,\n            startTime: ch.data.startTime / 1000,\n            endTime: ch.data.endTime / 1000,\n            title: ch.data.subFrames.TIT2.data,\n          }\n        }\n        return false\n      })\n      .sort((a, b) => a.id - b.id)\n  }\n  return { title, artist, cover, duration, chapters }\n}\n\nexport function createElement(options) {\n  options.tag = options.tag || 'div'\n  const el = document.createElement(options.tag)\n  if (options.className) {\n    if (typeof options.className === 'string') {\n      el.classList.add(options.className)\n    } else {\n      options.className.forEach(className => {\n        el.classList.add(className)\n      })\n    }\n  }\n  if (options.attrs) {\n    Object.keys(options.attrs).forEach(key => {\n      el.setAttribute(key, options.attrs[key])\n    })\n  }\n  if (options.innerHTML) {\n    el.innerHTML = options.innerHTML\n  }\n  return el\n}\n\nexport function toggleAttribute(el, name) {\n  if (typeof el.toggleAttribute === 'function') {\n    el.toggleAttribute(name)\n    return\n  }\n  if (el.hasAttribute(name)) {\n    el.removeAttribute(name)\n  } else {\n    el.setAttribute(name, '')\n  }\n}\n\nexport function animateScroll(\n  timestamp,\n  startTime,\n  duration,\n  startPos,\n  distance,\n  scrollEl) {\n  const elapsed = (timestamp - startTime) / 1000\n  const t = elapsed / duration\n\n  // easing in a linear fashion\n  scrollEl.scrollTop = startPos + distance * t\n  if (t < 1) {\n    window.requestAnimationFrame(ts => {\n      animateScroll(ts, startTime, duration, startPos, distance, scrollEl)\n    })\n  }\n}\n","/**\n * focus-visible polyfill for button and progress handle from\n * https://github.com/WICG/focus-visible/blob/master/src/focus-visible.js\n * stripped only relevent section and replace manipulating the whole document to only a certain element, i.e. shikwasa player to prevent changing document behavior\n */\nfunction applyFocusVisiblePolyfill(parent, supportsPassive) {\n  var hadKeyboardEvent = true\n  var hadFocusVisibleRecently = false\n  var hadFocusVisibleRecentlyTimeout = null\n\n  /**\n   * Helper function for legacy browsers and iframes which sometimes focus\n   * elements like document, body, and non-interactive SVG.\n   * @param {Element} el\n   */\n  function isValidFocusTarget(el) {\n    if (\n      el &&\n      el !== document &&\n      el.nodeName !== 'HTML' &&\n      el.nodeName !== 'BODY' &&\n      'classList' in el &&\n      'contains' in el.classList\n    ) {\n      return true\n    }\n    return false\n  }\n\n  /**\n   * Add the `focus-visible` class to the given element if it was not added by\n   * the author.\n   * @param {Element} el\n   */\n  function addFocusVisibleClass(el) {\n    if (el.classList.contains('focus-visible')) {\n      return\n    }\n    el.classList.add('focus-visible')\n    el.setAttribute('data-focus-visible-added', '')\n  }\n\n  /**\n   * Remove the `focus-visible` class from the given element if it was not\n   * originally added by the author.\n   * @param {Element} el\n   */\n  function removeFocusVisibleClass(el) {\n    if (!el.hasAttribute('data-focus-visible-added')) {\n      return\n    }\n    el.classList.remove('focus-visible')\n    el.removeAttribute('data-focus-visible-added')\n  }\n\n  /**\n   * If the most recent user interaction was via the keyboard;\n   * and the key press did not include a meta, alt/option, or control key;\n   * then the modality is keyboard. Otherwise, the modality is not keyboard.\n   * Apply `focus-visible` to any current active element and keep track\n   * of our keyboard modality state with `hadKeyboardEvent`.\n   * @param {KeyboardEvent} e\n   */\n  function onKeyDown(e) {\n    if (e.metaKey || e.altKey || e.ctrlKey) {\n      return\n    }\n\n    if (isValidFocusTarget(document.activeElement) && parent.contains(document.activeElement)) {\n      addFocusVisibleClass(document.activeElement)\n    }\n\n    hadKeyboardEvent = true\n  }\n\n  /**\n   * If at any point a user clicks with a pointing device, ensure that we change\n   * the modality away from keyboard.\n   * This avoids the situation where a user presses a key on an already focused\n   * element, and then clicks on a different element, focusing it with a\n   * pointing device, while we still think we're in keyboard modality.\n   * @param {Event} e\n   */\n  function onPointerDown() {\n    hadKeyboardEvent = false\n  }\n\n  /**\n   * On `focus`, add the `focus-visible` class to the target if:\n   * - the target received focus as a result of keyboard navigation, or\n   * - the event target is an element that will likely require interaction\n   *   via the keyboard (e.g. a text box)\n   * @param {Event} e\n   */\n  function onFocus(e) {\n    // Prevent IE from focusing the document or HTML element.\n    if (!isValidFocusTarget(e.target)) {\n      return\n    }\n\n    if (hadKeyboardEvent) {\n      addFocusVisibleClass(e.target)\n    }\n  }\n\n  /**\n   * On `blur`, remove the `focus-visible` class from the target.\n   * @param {Event} e\n   */\n  function onBlur(e) {\n    if (!isValidFocusTarget(e.target)) {\n      return\n    }\n\n    if (\n      e.target.classList.contains('focus-visible') ||\n      e.target.hasAttribute('data-focus-visible-added')\n    ) {\n      // To detect a tab/window switch, we look for a blur event followed\n      // rapidly by a visibility change.\n      // If we don't see a visibility change within 100ms, it's probably a\n      // regular focus change.\n      hadFocusVisibleRecently = true\n      window.clearTimeout(hadFocusVisibleRecentlyTimeout)\n      hadFocusVisibleRecentlyTimeout = window.setTimeout(function () {\n        hadFocusVisibleRecently = false\n      }, 100)\n      removeFocusVisibleClass(e.target)\n    }\n  }\n  /**\n   * If the user changes tabs, keep track of whether or not the previously\n   * focused element had .focus-visible.\n   * @param {Event} e\n   */\n\n  function onVisibilityChange() {\n    if (document.visibilityState === 'hidden') {\n      // If the tab becomes active again, the browser will handle calling focus\n      // on the element (Safari actually calls it twice).\n      // If this tab change caused a blur on an element with focus-visible,\n      // re-apply the class when the user switches back to the tab.\n      if (hadFocusVisibleRecently) {\n        hadKeyboardEvent = true\n      }\n      addInitialPointerMoveListeners()\n    }\n  }\n  function addInitialPointerMoveListeners() {\n    parent.addEventListener('mousemove', onInitialPointerMove)\n    parent.addEventListener('mousedown', onInitialPointerMove)\n    parent.addEventListener('mouseup', onInitialPointerMove)\n    parent.addEventListener('pointermove', onInitialPointerMove)\n    parent.addEventListener('pointerdown', onInitialPointerMove)\n    parent.addEventListener('pointerup', onInitialPointerMove)\n    parent.addEventListener('touchmove', onInitialPointerMove, supportsPassive ? { passive: true } : false)\n    parent.addEventListener('touchstart', onInitialPointerMove, supportsPassive ? { passive: true } : false)\n    parent.addEventListener('touchend', onInitialPointerMove, supportsPassive ? { passive: true } : false)\n  }\n\n  function removeInitialPointerMoveListeners(el) {\n    parent.removeEventListener('mousemove', onInitialPointerMove)\n    parent.removeEventListener('mousedown', onInitialPointerMove)\n    parent.removeEventListener('mouseup', onInitialPointerMove)\n    parent.removeEventListener('pointermove', el)\n    parent.removeEventListener('pointerdown', onInitialPointerMove)\n    parent.removeEventListener('pointerup', onInitialPointerMove)\n    parent.removeEventListener('touchmove', onInitialPointerMove, supportsPassive ? { passive: true } : false)\n    parent.removeEventListener('touchstart', onInitialPointerMove, supportsPassive ? { passive: true } : false)\n    parent.removeEventListener('touchend', onInitialPointerMove, supportsPassive ? { passive: true } : false)\n  }\n  /**\n   * When the polfyill first loads, assume the user is in keyboard modality.\n   * If any event is received from a pointing device (e.g. mouse, pointer,\n   * touch), turn off keyboard modality.\n   * This accounts for situations where focus enters the page from the URL bar.\n   * @param {Event} e\n   */\n  function onInitialPointerMove() {\n    hadKeyboardEvent = false\n    removeInitialPointerMoveListeners()\n  }\n\n  // For some kinds of state, we are interested in changes at the global scope\n  // only. For example, global pointer input, global key presses and global\n  // visibility change should affect the state at every scope:\n  parent.addEventListener('keydown', onKeyDown, true)\n  parent.addEventListener('mousedown', onPointerDown, true)\n  parent.addEventListener('pointerdown', onPointerDown, true)\n  parent.addEventListener('touchstart', onPointerDown, supportsPassive ? { passive: true, capture: true } : true)\n  parent.addEventListener('visibilitychange', onVisibilityChange, true)\n\n  addInitialPointerMoveListeners()\n\n  // For focus and blur, we specifically care about state changes in the local\n  // scope. This is because focus / blur events that originate from within a\n  // shadow root are not re-dispatched from the host element if it was already\n  // the active element in its own scope:\n  parent.addEventListener('focus', onFocus, true)\n  parent.addEventListener('blur', onBlur, true)\n\n  parent.classList.add('js-focus-visible')\n}\n\nexport default applyFocusVisiblePolyfill\n","import PlayerComp from './templates/Player'\nimport IconComp from './templates/Icon'\nimport { secondToTime, numToString, marquee, createElement, toggleAttribute } from './utils'\nimport applyFocusVisible from './focus-visible'\n\nlet resize, coverUrl = null, cooldown = true\n\nexport default class UI {\n  constructor(options) {\n    this.mounted = false\n    if (!document.querySelector('.shk-icons')) {\n      this.icons = createElement({\n        className: 'shk-icons',\n        innerHTML: IconComp,\n      })\n    }\n    this.initEl()\n    this.initOptions(options)\n  }\n\n  async initEl() {\n    this.el = createElement({\n      className: ['shk', 'shikwasa'],\n      attrs: {\n        'data-name': 'shikwasa',\n      },\n      innerHTML: PlayerComp,\n    })\n    this.playBtn = this.el.querySelector('.shk-btn_toggle')\n    this.fwdBtn = this.el.querySelector('.shk-btn_forward')\n    this.bwdBtn = this.el.querySelector('.shk-btn_backward')\n    this.speedBtn = this.el.querySelector('.shk-btn_speed')\n    this.moreBtn = this.el.querySelector('.shk-btn_more')\n    this.muteBtn = this.el.querySelector('.shk-btn_volume')\n    this.extraControls = this.el.querySelector('.shk-controls_extra')\n    this.texts = this.el.querySelector('.shk-text')\n    this.artist = this.el.querySelector('.shk-artist')\n    this.artistWrap = this.el.querySelector('.shk-artist_wrap')\n    this.titleWrap = this.el.querySelector('.shk-title_wrap')\n    this.titleInner = this.el.querySelector('.shk-title_inner')\n    this.title = this.el.querySelector('.shk-title')\n    this.currentTime = this.el.querySelector('.shk-time_now')\n    this.duration = this.el.querySelector('.shk-time_duration')\n    this.bar = this.el.querySelector('.shk-bar')\n    this.barWrap = this.el.querySelector('.shk-bar_wrap')\n    this.audioPlayed = this.el.querySelector('.shk-bar_played')\n    this.audioLoaded = this.el.querySelector('.shk-bar_loaded')\n    this.handle = this.el.querySelector('.shk-bar-handle')\n    this.cover = this.el.querySelector('.shk-cover')\n    this.seekControls = [\n      this.fwdBtn,\n      this.bwdBtn,\n      this.handle,\n    ]\n  }\n\n  initOptions(options) {\n\n    // dark mode\n    this.el.style = `--color-primary: ${options.themeColor}`\n    this.el.setAttribute('data-theme', options.theme)\n\n    // download\n    if (options.download && options.audio && options.audio.src) {\n      this.downloadBtn = createElement({\n        tag: 'a',\n        className: ['shk-btn', 'shk-btn_download'],\n        attrs: {\n          title: 'download',\n          'aria-label': 'download',\n          href: typeof options.download === 'string' ? options.download : options.audio.src,\n          download: '',\n          target: '_blank',\n          rel: 'noopener noreferrer',\n        },\n        innerHTML: /* html */`\n          <svg aria-hidden=\"true\">\n            <use xlink:href=\"#shk-icon_download\" />\n          </svg>\n        `,\n      })\n      this.extraControls.append(this.downloadBtn)\n    }\n\n    // player position\n    this.el.setAttribute('data-fixed-type', options.fixed.type)\n    if (options.fixed.type !== 'static' && options.fixed.position === 'top') {\n      this.el.setAttribute('data-fixed-pos', options.fixed.position)\n    }\n\n    // player status display\n    const playStatus = options.autoPlay ? 'playing' : 'paused'\n    this.el.setAttribute('data-play', playStatus)\n\n    // mute status display\n    if (options.muted) {\n      this.el.setAttribute('data-mute', '')\n    }\n  }\n\n  initEvents(supportsPassive) {\n    this.moreBtn.addEventListener('click', () => {\n      toggleAttribute(this.el, 'data-extra')\n    })\n    Array.from(this.extraControls.children).forEach(el => {\n      this.hideExtraControl(el)\n    })\n\n    // add keyboard focus style\n    applyFocusVisible(this.el, supportsPassive)\n\n    resize = () => {\n      if (!cooldown) return\n      cooldown = false\n      setTimeout(() => cooldown = true, 100)\n      marquee.call(this, this.titleWrap, this.title)\n    }\n    window.addEventListener('resize', resize)\n  }\n\n  setAudioInfo(audio = {}) {\n    if (coverUrl) {\n      URL.revokeObjectURL(coverUrl)\n      coverUrl = null\n    }\n    if (/blob/.test(audio.cover)) {\n      coverUrl = audio.cover\n    }\n    if (audio.cover) {\n      this.cover.style.backgroundImage = `url(${audio.cover})`\n    } else {\n      this.cover.style.backgroundImage = 'none'\n    }\n    this.title.innerHTML = audio.title\n    this.titleInner.setAttribute('data-title', audio.title)\n    this.artist.innerHTML = audio.artist\n    if (audio.duration) {\n      this.duration.innerHTML = secondToTime(audio.duration)\n    }\n    if (this.downloadBtn) {\n      this.downloadBtn.href= audio.src\n    }\n    this.setBar('loaded', 0)\n  }\n\n  setPlaying() {\n    this.el.setAttribute('data-play', 'playing')\n  }\n\n  setPaused() {\n    this.el.setAttribute('data-play', 'paused')\n    this.el.removeAttribute('data-loading')\n  }\n\n  setTime(type, time) {\n    this[type].innerHTML = secondToTime(time)\n  }\n\n  setBar(type, percentage) {\n    const typeName = 'audio' + type.charAt(0).toUpperCase() + type.substr(1)\n    percentage = Math.min(percentage, 1)\n    percentage = Math.max(percentage, 0)\n    this[typeName].style.width = percentage * 100 + '%'\n    const ariaNow = percentage.toFixed(2)\n    this[typeName].setAttribute('aria-valuenow', ariaNow)\n    this.handle.setAttribute('aria-valuenow', ariaNow)\n  }\n\n  setProgress(time = 0, percentage = 0, duration = 0) {\n    if (time && !percentage) {\n      percentage = duration ? time / duration : 0\n    } else {\n      time = percentage * (duration || 0)\n    }\n    this.setTime('currentTime', time)\n    this.setBar('played', percentage)\n  }\n\n  setSpeed(speed) {\n    this.speedBtn.innerHTML = numToString(speed) + 'x'\n  }\n\n  getPercentByPos(e) {\n    const handlePos = e.clientX || (e.changedTouches && e.changedTouches[0].clientX) || 0\n    const initPos = this.barWrap.getBoundingClientRect().left\n    const barLength = this.barWrap.clientWidth\n    let percentage = (handlePos - initPos) / barLength\n    percentage = Math.min(percentage, 1)\n    percentage = Math.max(0, percentage)\n    return percentage\n  }\n\n  hideExtraControl(el) {\n    el.addEventListener('click', () => {\n      setTimeout(() => {\n        this.el.removeAttribute('data-extra')\n      }, 800)\n    })\n  }\n\n  mount(container, supportsPassive) {\n    container.innerHTML = ''\n    container.append(this.el)\n    if (this.icons) {\n      container.append(this.icons)\n    }\n    this.mounted = true\n    this.initEvents(supportsPassive)\n    marquee(this.titleWrap, this.title)\n  }\n\n  destroy() {\n    window.removeEventListener('resize', resize)\n    if (coverUrl) {\n      URL.revokeObjectURL(coverUrl)\n    }\n  }\n}\n","export default class Events {\n  constructor() {\n    this.audioEvents = ['abort', 'canplay', 'canplaythrough', 'complete', 'durationchange', 'emptied', 'ended', 'error', 'loadeddata', 'loadedmetadata', 'loadstart', 'pause', 'play', 'playing', 'progress', 'ratechange', 'seeked', 'seeking', 'stalled', 'suspend', 'timeupdate', 'volumechange', 'waiting']\n    this.playerEvents = ['audioupdate', 'audioparse']\n    this.events = {}\n  }\n\n  on(name, callback) {\n    if (this.type(name) && typeof callback == 'function') {\n      if (!this.events[name]) {\n        this.events[name] = []\n      }\n      this.events[name].push(callback)\n    }\n  }\n\n  trigger(name, data = {}) {\n    if (this.events[name] && this.events[name].length) {\n      this.events[name].forEach(fn => fn(data))\n    }\n  }\n\n  type(name) {\n    if (this.playerEvents.indexOf(name) !== -1) {\n      return 'player'\n    } else if (this.audioEvents.indexOf(name) !== -1) {\n      return 'audio'\n    }\n    console.error(`Shikwasa: unknown event name: ${name}`)\n    return null\n  }\n}\n","import UI from './ui'\nimport Events from './events'\nimport { toggleAttribute, handleOptions, handleAudio, parseAudio } from './utils'\n\nconst playerArr = []\nconst REGISTERED_COMPS = []\nconst isMobile = typeof window !== 'undefined' ? /mobile/i.test(window.navigator.userAgent) : false\nconst dragStart = isMobile ? 'touchstart' : 'mousedown'\nconst dragMove = isMobile ? 'touchmove' : 'mousemove'\nconst dragEnd = isMobile ? 'touchend' : 'mouseup'\n\n// detecting addEventListener option support\nlet supportsPassive = false\nif (typeof window !== 'undefined') {\n  try {\n    const opts = Object.defineProperty({}, 'passive', {\n      get: function () {\n        supportsPassive = true\n        return false\n      },\n    })\n    window.addEventListener('testPassvie', null, opts)\n    window.removeEventListener('testPassvie', null, opts)\n  } catch (e) {\n    supportsPassive = false\n  }\n}\nconst addPassive = supportsPassive && isMobile\n\nclass Player {\n  constructor(options) {\n    this.id = playerArr.length\n    playerArr.push(this)\n    this.comps = {}\n    this._audio = {}\n    this._hasMediaSession = false\n    this._initSeek = 0\n    this._canplay = false\n    this._dragging = false\n    this.events = new Events()\n    this.options = handleOptions(options)\n    this.renderComponents()\n    this.initUI(this.options)\n    this.initAudio()\n    this.ui.mount(this.options.container, supportsPassive)\n  }\n\n\n\n  get duration() {\n    if (!this.audio || !this.audio.duration) {\n      return this._audio.duration\n    }\n    return this.audio.duration\n  }\n\n  get seekable() {\n    return Boolean(this.duration)\n  }\n\n  set seekable(v) {\n    if (v) {\n      this.ui.seekControls.forEach(el => {\n        el.removeAttribute('disabled')\n      })\n    } else {\n      this.ui.seekControls.forEach(el => {\n        el.setAttribute('disabled', '')\n      })\n    }\n  }\n\n  get currentTime() {\n    return this.audio ? this.audio.currentTime : undefined\n  }\n\n  get playbackRate() {\n    return this.audio ? this.audio.playbackRate : undefined\n  }\n\n  set playbackRate(v) {\n    if (this.audio) {\n      this.audio.playbackRate = v\n      this.audio.defaultPlaybackRate = v\n    }\n  }\n\n  get muted() {\n    return this.audio ? this.audio.muted : undefined\n  }\n\n  set muted(v) {\n    if (this.audio) {\n      this.audio.muted = v\n      this.audio.defaultMuted = v\n    }\n  }\n\n  initUI() {\n    this.ui = new UI(this.options)\n    this.el = this.ui.el\n    this.initControlEvents()\n    this.initBarEvents()\n  }\n\n  initControlEvents() {\n    this.ui.playBtn.addEventListener('click', () => {\n      this.toggle()\n    })\n    this.ui.muteBtn.addEventListener('click', () => {\n      this.muted = !this.muted\n      toggleAttribute(this.el, 'data-mute')\n    })\n    this.ui.fwdBtn.addEventListener('click', () => {\n      this.seekBySpan()\n    })\n    this.ui.bwdBtn.addEventListener('click', () => {\n      this.seekBySpan({ forward: false })\n    })\n    this.ui.speedBtn.addEventListener('click', () => {\n      const index = this.options.speedOptions.indexOf(this.playbackRate)\n      const speedRange = this.options.speedOptions\n      this.playbackRate = (index + 1 >= speedRange.length) ? speedRange[0] : speedRange[index + 1]\n      this.ui.setSpeed(this.playbackRate)\n    })\n  }\n\n  initBarEvents() {\n    let targetTime = 0\n    const dragStartHandler = (e) => {\n      if (!this.seekable) return\n      e.preventDefault()\n      this.el.setAttribute('data-seeking', '')\n      this._dragging = true\n      document.addEventListener(dragMove, dragMoveHandler, addPassive ? { passive: true } : false)\n      document.addEventListener(dragEnd, dragEndHandler)\n    }\n    const dragMoveHandler = (e) => {\n      this.ui.setProgress(null, this.ui.getPercentByPos(e), this.duration)\n    }\n    const dragEndHandler = (e) => {\n      e.preventDefault()\n      document.removeEventListener(dragMove, dragMoveHandler)\n      document.removeEventListener(dragEnd, dragEndHandler)\n      targetTime = this.ui.getPercentByPos(e) * this.duration\n      this.seek(targetTime)\n      this._dragging = false\n\n      // disable barPlayed transition on drag\n      setTimeout(() => this.el.removeAttribute('data-seeking'), 50)\n    }\n\n    // seeking with keyboard\n    const keydownHandler = (e) => {\n      if (!this.seekable) return\n\n      // for early browser compatibility\n      const key = e.key.replace('Arrow', '')\n\n      const backwardKeys = ['Left', 'Down']\n      const forwardKeys = ['Right', 'Up']\n      const largeStepKeys = ['PageDown', 'PageUp']\n      const edgeKeys = ['Home', 'End']\n      const isBack = backwardKeys.indexOf(key) !== -1\n      const isFwd = forwardKeys.indexOf(key) !== -1\n      const isWayBack = key === largeStepKeys[0]\n      const isWayFwd = key === largeStepKeys[1]\n      const isStart = key === edgeKeys[0]\n      const isEnd = key === edgeKeys[1]\n      if (!isBack && !isFwd && largeStepKeys.indexOf(key) === -1 && edgeKeys.indexOf(key) === -1) {\n        return\n      }\n      if (isStart) {\n        this.seek(0)\n        return\n      }\n      if (isEnd) {\n        this.seek(this.duration)\n        return\n      }\n      const step = (isWayFwd || isWayBack ? 0.1 : 0.01) * (isFwd || isWayFwd ? 1 : -1)\n      const currentTime = this._canplay ? this.currentTime : this._initSeek\n      const time = step * this.duration + currentTime\n      this.seek(time)\n    }\n    this.ui.barWrap.addEventListener(dragStart, dragStartHandler)\n    this.ui.handle.addEventListener('keydown', keydownHandler)\n  }\n\n  initAudio() {\n    if (this.options.audio.src) {\n      this.audio = new Audio()\n      this.initAudioEvents()\n      this.events.audioEvents.forEach(name => {\n        this.audio.addEventListener(name, (e) => {\n          this.events.trigger(name, e)\n        })\n      })\n      this.audio.preload = this.options.preload\n      this.muted = this.options.muted\n      this.update(this.options.audio)\n    }\n  }\n\n  initAudioEvents() {\n    this.on('play', () => {\n      this.ui.setPlaying()\n      playerArr.forEach(player => {\n        if (player.id !== this.id && player.audio && !player.audio.paused) {\n          player.pause()\n        }\n      })\n    })\n    this.on('pause', () => {\n      this.ui.setPaused()\n    })\n    this.on('ended', () => {\n      this.ui.setPaused()\n      this.seek(0)\n    })\n    this.on('waiting', () => {\n      this.el.setAttribute('data-loading', '')\n    })\n    this.on('durationchange', () => {\n      if (this.duration && this.duration !== 1) {\n        this.seekable = true\n        this.ui.setTime('duration', this.duration)\n      }\n    })\n    this.on('canplay', () => {\n      if (!this._canplay) {\n        this._canplay = true\n        if (this._initSeek) {\n          this.seek(this._initSeek)\n          this._initSeek = 0\n        }\n      }\n    })\n    this.on('canplaythrough', () => {\n      this.el.removeAttribute('data-loading')\n    })\n    this.on('progress', () => {\n      if (this.audio.buffered.length) {\n        const percentage = this.audio.buffered.length ? this.audio.buffered.end(this.audio.buffered.length - 1) / this.duration : 0\n        this.ui.setBar('loaded', percentage)\n      }\n    })\n    this.on('timeupdate', () => {\n      if (!this._dragging) {\n        this.ui.setProgress(this.audio.currentTime, null, this.duration)\n      }\n    })\n    this.on('abort', () => {\n      this.ui.setPaused()\n    })\n  }\n\n  initMediaSession() {\n    const self = this\n    if ('mediaSession' in navigator) {\n      this._hasMediaSession = true\n      this.setMediaMetadata(this._audio)\n      const controls = {\n        play: this.play.bind(self),\n        pause: this.pause.bind(self),\n        seekforward: this.seekBySpan.bind(self),\n        seekbackward: () => this.seekBySpan({ forward: false }),\n        seekto: this.seek.bind(self),\n      }\n      Object.keys(controls).forEach(key => {\n        navigator.mediaSession.setActionHandler(key, controls[key]\n        )\n      })\n    }\n  }\n\n  setMediaMetadata(audio) {\n    /* global MediaMetadata */\n    const artwork = audio.cover ? [{ src: audio.cover, sizes: '150x150'}] : undefined\n    navigator.mediaSession.metadata = new MediaMetadata({\n      title: audio.title,\n      artist: audio.artist,\n      album: audio.album,\n      artwork,\n    })\n  }\n\n  on(name, callback) {\n    this.events.on(name, callback)\n  }\n\n  play() {\n    if (!this.audio.paused) return\n    const promise = this.audio.play()\n    if (promise instanceof Promise) {\n      promise.then(() => {\n        this.initMediaSession()\n      })\n      promise.catch((e) => {\n        if (e.name === 'NotAllowedError' || e.name === 'NotSupportedError') {\n          this.pause()\n        }\n      })\n    } else {\n      this.initMediaSession()\n    }\n  }\n\n  pause() {\n    if (this.audio.paused) return\n    this.audio.pause()\n  }\n\n  toggle() {\n    this.audio.paused ? this.play() : this.pause()\n  }\n\n  seek(time) {\n    if (!this.seekable) return\n    time = parseInt(time)\n    if (isNaN(time)) {\n      console.error('Shikwasa: seeking time is NaN')\n    }\n    time = Math.min(time, this.duration)\n    time = Math.max(time, 0)\n    this.ui.setProgress(time, null, this.duration)\n    if (!this._canplay) {\n      this._initSeek = time\n    } else {\n      this.audio.currentTime = time\n    }\n  }\n\n  seekBySpan({ time = 10, forward = true } = {}) {\n    const currentTime = this._canplay ? this.audio.currentTime : this._initSeek\n    const targetTime = currentTime + time * (forward ? 1 : -1)\n    this.seek(targetTime)\n  }\n\n  update(audio) {\n    if (audio && audio.src) {\n      this._audio = handleAudio(audio)\n      this._canplay = false\n\n      this.audio.src = this._audio.src\n      this.updateAudioData(this._audio)\n      this.events.trigger('audioupdate', this._audio)\n      if (this.options.parser &&\n        (!audio.title ||\n        !audio.artist ||\n        !audio.cover ||\n        !audio.chapters)\n      ) {\n        parseAudio(Object.assign({}, audio), this.options.parser).then(audioData => {\n          this._audio = audioData || this._audio\n          this.updateAudioData(this._audio)\n          this.events.trigger('audioparse', this._audio)\n        })\n      }\n    } else {\n      throw new Error('Shikwasa: audio source is not specified')\n    }\n  }\n\n  updateAudioData(audio) {\n    this.audio.title = audio.title\n    this.ui.setAudioInfo(audio)\n    this.seekable = audio.duration\n    if (this._hasMediaSession) {\n      this.setMediaMetadata(audio)\n    }\n  }\n\n  destroyAudio() {\n    this.audio.pause()\n    this.audio.src = ''\n    this.audio.load()\n    this.audio = null\n  }\n\n  destroy() {\n    this.destroyAudio()\n    this.ui.destroy()\n    Object.keys(this.comps).forEach(k => {\n      if (this.comps[k].destroy &&\n        typeof this.comps[k].destroy === 'function') {\n        this.comps[k].destroy()\n      }\n    })\n    this.comps = null\n    this.options.container.innerHTML = ''\n  }\n\n  renderComponents() {\n    if (!REGISTERED_COMPS.length) return\n    REGISTERED_COMPS.forEach(comp => {\n      this.comps[comp._name] = new comp(this)\n    })\n  }\n}\n\nPlayer.use = function (comp) {\n  REGISTERED_COMPS.push(comp)\n}\n\nexport default Player\n","import './css/base.css'\nimport Shikwasa from './player'\n\nexport default Shikwasa\n/** CONSOLE_MSG */\n\n"],"names":["PlayerTemplate","IconTemplate","DEFAULT","container","document","querySelector","parser","fixed","type","position","download","themeColor","theme","autoPlay","muted","preload","speedOptions","audio","CONFIG","fixedOptions","audioOptions","title","artist","duration","NaN","cover","chapters","src","album","secondToTime","time","Math","round","hour","floor","min","sec","numToString","num","float","parseFloat","toFixed","slice","marquee","textWrap","textEl","speed","overflow","offsetWidth","setAttribute","style","animationDuration","removeAttribute","handleOptions","options","_options","Object","assign","keys","forEach","k","fixedType","find","item","Array","isArray","indexOf","push","map","sp","filter","isNaN","length","sort","a","b","handleAudio","parsedData","audioData","parseAudio","tags","parserWrap","tagData","handleParsedTags","Promise","resolve","reject","read","onSuccess","onError","picture","data","format","byteArray","Uint8Array","blob","Blob","URL","createObjectURL","TLEN","CHAP","ch","id","subFrames","TIT2","startTime","endTime","createElement","tag","el","className","classList","add","attrs","key","innerHTML","toggleAttribute","name","hasAttribute","applyFocusVisiblePolyfill","parent","supportsPassive","hadKeyboardEvent","hadFocusVisibleRecently","hadFocusVisibleRecentlyTimeout","isValidFocusTarget","nodeName","addFocusVisibleClass","contains","removeFocusVisibleClass","remove","onKeyDown","e","metaKey","altKey","ctrlKey","activeElement","onPointerDown","onFocus","target","onBlur","window","clearTimeout","setTimeout","onVisibilityChange","visibilityState","addInitialPointerMoveListeners","addEventListener","onInitialPointerMove","passive","removeInitialPointerMoveListeners","removeEventListener","capture","resize","coverUrl","cooldown","UI","constructor","mounted","icons","IconComp","initEl","initOptions","PlayerComp","playBtn","fwdBtn","bwdBtn","speedBtn","moreBtn","muteBtn","extraControls","texts","artistWrap","titleWrap","titleInner","currentTime","bar","barWrap","audioPlayed","audioLoaded","handle","seekControls","downloadBtn","href","rel","append","playStatus","initEvents","from","children","hideExtraControl","applyFocusVisible","call","setAudioInfo","revokeObjectURL","test","backgroundImage","setBar","setPlaying","setPaused","setTime","percentage","typeName","charAt","toUpperCase","substr","max","width","ariaNow","setProgress","setSpeed","getPercentByPos","handlePos","clientX","changedTouches","initPos","getBoundingClientRect","left","barLength","clientWidth","mount","destroy","Events","audioEvents","playerEvents","events","on","callback","trigger","fn","console","error","playerArr","REGISTERED_COMPS","isMobile","navigator","userAgent","dragStart","dragMove","dragEnd","opts","defineProperty","get","addPassive","Player","comps","_audio","_hasMediaSession","_initSeek","_canplay","_dragging","renderComponents","initUI","initAudio","ui","seekable","Boolean","v","undefined","playbackRate","defaultPlaybackRate","defaultMuted","initControlEvents","initBarEvents","toggle","seekBySpan","forward","index","speedRange","targetTime","dragStartHandler","preventDefault","dragMoveHandler","dragEndHandler","seek","keydownHandler","replace","backwardKeys","forwardKeys","largeStepKeys","edgeKeys","isBack","isFwd","isWayBack","isWayFwd","isStart","isEnd","step","Audio","initAudioEvents","update","player","paused","pause","buffered","end","initMediaSession","self","setMediaMetadata","controls","play","bind","seekforward","seekbackward","seekto","mediaSession","setActionHandler","artwork","sizes","metadata","MediaMetadata","promise","then","catch","parseInt","updateAudioData","Error","destroyAudio","load","comp","_name","use"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAAA,IAAMA,cAAc;AAAA,0yIAApB,CCAA,IAAMC,YAAY;AAAA,w4JAAlB;ACAO,IAAMC,OAAO,GAAG;AACrBC,EAAAA,SAAS,EAAE,MAAMC,QAAQ,CAACC,aAAT,CAAuB,MAAvB,CADI;AAErBC,EAAAA,MAAM,EAAE,IAFa;AAGrBC,EAAAA,KAAK,EAAE;AACLC,IAAAA,IAAI,EAAE,MADD;AAELC,IAAAA,QAAQ,EAAE;AAFL,GAHc;AAOrBC,EAAAA,QAAQ,EAAE,KAPW;AAQrBC,EAAAA,UAAU,EAAE,SARS;AASrBC,EAAAA,KAAK,EAAE,MATc;AAUrBC,EAAAA,QAAQ,EAAE,KAVW;AAWrBC,EAAAA,KAAK,EAAE,KAXc;AAYrBC,EAAAA,OAAO,EAAE,UAZY;AAarBC,EAAAA,YAAY,EAAE,CAAC,GAAD,EAAM,IAAN,EAAY,CAAZ,EAAe,IAAf,EAAqB,GAArB,CAbO;AAcrBC,EAAAA,KAAK,EAAE;AAdc,CAAhB;AAiBA,IAAMC,MAAM,GAAG;AACpBC,EAAAA,YAAY,EAAE,CAAC,MAAD,EAAS,QAAT,EAAmB,OAAnB,CADM;AAEpBC,EAAAA,YAAY,EAAE;AACZC,IAAAA,KAAK,EAAE,eADK;AAEZC,IAAAA,MAAM,EAAE,gBAFI;AAGZC,IAAAA,QAAQ,EAAEC,GAHE;AAIZC,IAAAA,KAAK,EAAE,IAJK;AAKZC,IAAAA,QAAQ,EAAE,EALE;AAMZC,IAAAA,GAAG,EAAE,IANO;AAOZC,IAAAA,KAAK,EAAE;AAPK;AAFM,CAAf,CCfA,SAASC,YAAT,CAAsBC,IAAtB,EAA4B;AACjCA,EAAAA,IAAI,GAAGC,IAAI,CAACC,KAAL,CAAWF,IAAX,CAAP;AACA,MAAIG,IAAI,GAAGF,IAAI,CAACG,KAAL,CAAWJ,IAAI,GAAG,IAAlB,CAAX;AACA,MAAIK,GAAG,GAAGJ,IAAI,CAACG,KAAL,CAAW,CAACJ,IAAI,GAAGG,IAAI,GAAG,IAAf,IAAuB,EAAlC,CAAV;AACA,MAAIG,GAAG,GAAGL,IAAI,CAACG,KAAL,CAAWJ,IAAI,GAAGG,IAAI,GAAG,IAAd,GAAqBE,GAAG,GAAG,EAAtC,CAAV;AACAA,EAAAA,GAAG,GAAGA,GAAG,GAAG,EAAN,GAAW,MAAMA,GAAjB,GAAuBA,GAA7B;AACAC,EAAAA,GAAG,GAAGA,GAAG,GAAG,EAAN,GAAW,MAAMA,GAAjB,GAAuBA,GAA7B;AACA,MAAIH,IAAI,KAAK,CAAb,EAAgB;AACd,qBAAUE,GAAV,cAAiBC,GAAjB;AACD;AACDH,EAAAA,IAAI,GAAGA,IAAI,GAAG,EAAP,GAAY,MAAMA,IAAlB,GAAyBA,IAAhC;AACA,mBAAUA,IAAV,cAAkBE,GAAlB,cAAyBC,GAAzB;AACD;AAEM,SAASC,WAAT,CAAqBC,GAArB,EAA0B;AAC/B,MAAMC,KAAK,GAAGC,UAAU,CAACF,GAAD,CAAV,CAAgBG,OAAhB,CAAwB,CAAxB,CAAd;AACA,SAAOF,KAAK,CAACG,KAAN,CAAY,CAAC,CAAb,MAAoB,GAApB,GAA0BH,KAAK,CAACG,KAAN,CAAY,CAAZ,EAAe,CAAC,CAAhB,CAA1B,GAA8CH,KAArD;AACD;AAEM,SAASI,OAAT,CAAiBC,QAAjB,EAA2BC,MAA3B,EAA+C;AAAA,MAAZC,KAAY,uEAAJ,EAAI;AACpD,MAAMC,QAAQ,GAAGF,MAAM,CAACG,WAAP,GAAqBJ,QAAQ,CAACI,WAA/C;AACA,MAAID,QAAQ,GAAG,CAAf,EAAkB;AAChBH,IAAAA,QAAQ,CAACK,YAAT,CAAsB,eAAtB,EAAuC,EAAvC;AACA,QAAM1B,QAAQ,GAAGsB,MAAM,CAACG,WAAP,GAAqBF,KAAtC;AACAF,IAAAA,QAAQ,CAACM,KAAT,CAAeC,iBAAf,aAAsC5B,QAAtC;AACD,GAJD,MAIO;AACLqB,IAAAA,QAAQ,CAACQ,eAAT,CAAyB,eAAzB;AACD;AACF;AAEM,SAASC,aAAT,CAAuBC,OAAvB,EAAgC;AACrC,MAAMC,QAAQ,GAAGC,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBH,OAAlB,CAAjB;AACAC,EAAAA,QAAQ,CAACtC,KAAT,GAAiBuC,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBH,OAAO,CAACrC,KAA1B,CAAjB;AACAuC,EAAAA,MAAM,CAACE,IAAP,CAAYxD,OAAZ,EAAqByD,OAArB,CAA6BC,CAAC,IAAI;AAChCL,IAAAA,QAAQ,CAACK,CAAD,CAAR,GAAeL,QAAQ,CAACK,CAAD,CAAR,IAAe,OAAOL,QAAQ,CAACK,CAAD,CAAf,KAAuB,SAAvC,GACZL,QAAQ,CAACK,CAAD,CADI,GACE1D,OAAO,CAAC0D,CAAD,CADvB;AAED,GAHD;AAIA,MAAI,OAAOL,QAAQ,CAACpD,SAAhB,KAA8B,UAAlC,EAA8C;AAC5CoD,IAAAA,QAAQ,CAACpD,SAAT,GAAqBoD,QAAQ,CAACpD,SAAT,EAArB;AACD;AACD,MAAM0D,SAAS,GAAG3C,MAAM,CAACC,YAAP,CAAoB2C,IAApB,CAAyBC,IAAI,IAAIA,IAAI,KAAKR,QAAQ,CAAChD,KAAT,CAAeC,IAAzD,CAAlB;AACA,MAAI,CAACqD,SAAL,EAAgB;AACdN,IAAAA,QAAQ,CAAChD,KAAT,CAAeC,IAAf,GAAsBN,OAAO,CAACK,KAAR,CAAcC,IAApC;AACD;AACD,MAAI,CAACwD,KAAK,CAACC,OAAN,CAAcV,QAAQ,CAACvC,YAAvB,CAAL,EAA2C;AACzCuC,IAAAA,QAAQ,CAACvC,YAAT,GAAwB,CAACuC,QAAQ,CAACvC,YAAV,CAAxB;AACD;AACD,MAAIuC,QAAQ,CAACvC,YAAT,CAAsBkD,OAAtB,CAA8B,CAA9B,MAAqC,CAAC,CAA1C,EAA6C;AAC3CX,IAAAA,QAAQ,CAACvC,YAAT,CAAsBmD,IAAtB,CAA2B,CAA3B;AACD;AACDZ,EAAAA,QAAQ,CAACvC,YAAT,GAAwBuC,QAAQ,CAACvC,YAAT,CACrBoD,GADqB,CACjBC,EAAE,IAAI7B,UAAU,CAAC6B,EAAD,CADC,EAErBC,MAFqB,CAEdD,EAAE,IAAI,CAACE,KAAK,CAACF,EAAD,CAFE,CAAxB;AAGA,MAAId,QAAQ,CAACvC,YAAT,CAAsBwD,MAAtB,GAA+B,CAAnC,EAAsC;AACpCjB,IAAAA,QAAQ,CAACvC,YAAT,CAAsByD,IAAtB,CAA2B,CAACC,CAAD,EAAIC,CAAJ,KAAUD,CAAC,GAAGC,CAAzC;AACD;AACD,SAAOpB,QAAP;AACD;AAEM,SAASqB,WAAT,GAAkD;AAAA,MAA7B3D,KAA6B,uEAArB,EAAqB;AAAA,MAAjB4D,UAAiB,uEAAJ,EAAI;AACvD,MAAIC,SAAS,GAAGtB,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBxC,KAAlB,CAAhB;AACAuC,EAAAA,MAAM,CAACE,IAAP,CAAYxC,MAAM,CAACE,YAAnB,EAAiCuC,OAAjC,CAAyCC,CAAC,IAAI;AAC5CkB,IAAAA,SAAS,CAAClB,CAAD,CAAT,GAAekB,SAAS,CAAClB,CAAD,CAAT,IACbiB,UAAU,CAACjB,CAAD,CADG,IAEb1C,MAAM,CAACE,YAAP,CAAoBwC,CAApB,CAFF;AAGD,GAJD;AAKA,SAAOkB,SAAP;AACD;SAEqBC,UAAtB;AAAA;AAAA;;kCAAO,aAAmD;AAAA,QAAzB9D,KAAyB,uEAAjB,EAAiB;AAAA,QAAbX,MAAa,uEAAJ,EAAI;AACxD,QAAM;AAAE0E,MAAAA;AAAF,QAAW,OAAMC,UAAU,CAAChE,KAAK,CAACU,GAAP,EAAYrB,MAAZ,CAAhB,KAAuC,EAAxD;AACA,QAAM4E,OAAO,GAAGC,gBAAgB,CAACH,IAAD,CAAhC;AACA,WAAOJ,WAAW,CAAC3D,KAAD,EAAQiE,OAAR,CAAlB;AACD;;;AAEM,SAASD,UAAT,CAAoBtD,GAApB,EAAyBrB,MAAzB,EAAiC;AACtC,SAAO,IAAI8E,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACtChF,IAAAA,MAAM,CAACiF,IAAP,CAAY5D,GAAZ,EAAiB;AACf6D,MAAAA,SAAS,EAAEH,OADI;AAEfI,MAAAA,OAAO,EAAEH;AAFM,KAAjB;AAID,GALM,CAAP;AAMD;AAEM,SAASH,gBAAT,GAAqC;AAAA,MAAXH,IAAW,uEAAJ,EAAI;AAC1C,MAAIvD,KAAJ,EAAWC,QAAX,EAAqBH,QAArB;AACA,MAAM;AAAEF,IAAAA,KAAF;AAASC,IAAAA;AAAT,MAAoB0D,IAA1B;AACA,MAAIA,IAAI,CAACU,OAAL,IAAgBV,IAAI,CAACU,OAAL,CAAaC,IAA7B,IAAqCX,IAAI,CAACU,OAAL,CAAaE,MAAtD,EAA8D;AAC5D,QAAMC,SAAS,GAAG,IAAIC,UAAJ,CAAed,IAAI,CAACU,OAAL,CAAaC,IAA5B,CAAlB;AACA,QAAMI,IAAI,GAAG,IAAIC,IAAJ,CAAS,CAACH,SAAD,CAAT,EAAsB;AAAErF,MAAAA,IAAI,EAAEwE,IAAI,CAACU,OAAL,CAAaE;AAArB,KAAtB,CAAb;AACAnE,IAAAA,KAAK,GAAGwE,GAAG,CAACC,eAAJ,CAAoBH,IAApB,CAAR;AACD;AACD,MAAIf,IAAI,CAACmB,IAAL,IAAanB,IAAI,CAACmB,IAAL,CAAUR,IAA3B,EAAiC;AAC/BpE,IAAAA,QAAQ,GAAG,CAACyD,IAAI,CAACmB,IAAL,CAAUR,IAAX,GAAkB,IAA7B;AACD;AACD,MAAIX,IAAI,CAACoB,IAAL,IAAapB,IAAI,CAACoB,IAAL,CAAU5B,MAA3B,EAAmC;AACjC9C,IAAAA,QAAQ,GAAGsD,IAAI,CAACoB,IAAL,CACR9B,MADQ,CACD+B,EAAE,IAAIA,EAAE,CAACC,EAAH,KAAU,MADf,EAERlC,GAFQ,CAEJiC,EAAE,IAAI;AACT,UAAIA,EAAE,CAACV,IAAH,IAAWU,EAAE,CAACV,IAAH,CAAQY,SAAnB,IAAgCF,EAAE,CAACV,IAAH,CAAQY,SAAR,CAAkBC,IAAtD,EAA4D;AAC1D,eAAO;AACLF,UAAAA,EAAE,EAAED,EAAE,CAACV,IAAH,CAAQW,EADP;AAELG,UAAAA,SAAS,EAAEJ,EAAE,CAACV,IAAH,CAAQc,SAAR,GAAoB,IAF1B;AAGLC,UAAAA,OAAO,EAAEL,EAAE,CAACV,IAAH,CAAQe,OAAR,GAAkB,IAHtB;AAILrF,UAAAA,KAAK,EAAEgF,EAAE,CAACV,IAAH,CAAQY,SAAR,CAAkBC,IAAlB,CAAuBb;AAJzB,SAAP;AAMD;AACD,aAAO,KAAP;AACD,KAZQ,EAaRlB,IAbQ,CAaH,CAACC,CAAD,EAAIC,CAAJ,KAAUD,CAAC,CAAC4B,EAAF,GAAO3B,CAAC,CAAC2B,EAbhB,CAAX;AAcD;AACD,SAAO;AAAEjF,IAAAA,KAAF;AAASC,IAAAA,MAAT;AAAiBG,IAAAA,KAAjB;AAAwBF,IAAAA,QAAxB;AAAkCG,IAAAA;AAAlC,GAAP;AACD;AAEM,SAASiF,aAAT,CAAuBrD,OAAvB,EAAgC;AACrCA,EAAAA,OAAO,CAACsD,GAAR,GAActD,OAAO,CAACsD,GAAR,IAAe,KAA7B;AACA,MAAMC,EAAE,GAAGzG,QAAQ,CAACuG,aAAT,CAAuBrD,OAAO,CAACsD,GAA/B,CAAX;AACA,MAAItD,OAAO,CAACwD,SAAZ,EAAuB;AACrB,QAAI,OAAOxD,OAAO,CAACwD,SAAf,KAA6B,QAAjC,EAA2C;AACzCD,MAAAA,EAAE,CAACE,SAAH,CAAaC,GAAb,CAAiB1D,OAAO,CAACwD,SAAzB;AACD,KAFD,MAEO;AACLxD,MAAAA,OAAO,CAACwD,SAAR,CAAkBnD,OAAlB,CAA0BmD,SAAS,IAAI;AACrCD,QAAAA,EAAE,CAACE,SAAH,CAAaC,GAAb,CAAiBF,SAAjB;AACD,OAFD;AAGD;AACF;AACD,MAAIxD,OAAO,CAAC2D,KAAZ,EAAmB;AACjBzD,IAAAA,MAAM,CAACE,IAAP,CAAYJ,OAAO,CAAC2D,KAApB,EAA2BtD,OAA3B,CAAmCuD,GAAG,IAAI;AACxCL,MAAAA,EAAE,CAAC5D,YAAH,CAAgBiE,GAAhB,EAAqB5D,OAAO,CAAC2D,KAAR,CAAcC,GAAd,CAArB;AACD,KAFD;AAGD;AACD,MAAI5D,OAAO,CAAC6D,SAAZ,EAAuB;AACrBN,IAAAA,EAAE,CAACM,SAAH,GAAe7D,OAAO,CAAC6D,SAAvB;AACD;AACD,SAAON,EAAP;AACD;AAEM,SAASO,eAAT,CAAyBP,EAAzB,EAA6BQ,IAA7B,EAAmC;AACxC,MAAI,OAAOR,EAAE,CAACO,eAAV,KAA8B,UAAlC,EAA8C;AAC5CP,IAAAA,EAAE,CAACO,eAAH,CAAmBC,IAAnB;AACA;AACD;AACD,MAAIR,EAAE,CAACS,YAAH,CAAgBD,IAAhB,CAAJ,EAA2B;AACzBR,IAAAA,EAAE,CAACzD,eAAH,CAAmBiE,IAAnB;AACD,GAFD,MAEO;AACLR,IAAAA,EAAE,CAAC5D,YAAH,CAAgBoE,IAAhB,EAAsB,EAAtB;AACD;AACF,CChJD,SAASE,yBAAT,CAAmCC,MAAnC,EAA2CC,eAA3C,EAA4D;AAC1D,MAAIC,gBAAgB,GAAG,IAAvB;AACA,MAAIC,uBAAuB,GAAG,KAA9B;AACA,MAAIC,8BAA8B,GAAG,IAArC;AAOA,WAASC,kBAAT,CAA4BhB,EAA5B,EAAgC;AAC9B,QACEA,EAAE,IACFA,EAAE,KAAKzG,QADP,IAEAyG,EAAE,CAACiB,QAAH,KAAgB,MAFhB,IAGAjB,EAAE,CAACiB,QAAH,KAAgB,MAHhB,IAIA,eAAejB,EAJf,IAKA,cAAcA,EAAE,CAACE,SANnB,EAOE;AACA,aAAO,IAAP;AACD;AACD,WAAO,KAAP;AACD;AAOD,WAASgB,oBAAT,CAA8BlB,EAA9B,EAAkC;AAChC,QAAIA,EAAE,CAACE,SAAH,CAAaiB,QAAb,CAAsB,eAAtB,CAAJ,EAA4C;AAC1C;AACD;AACDnB,IAAAA,EAAE,CAACE,SAAH,CAAaC,GAAb,CAAiB,eAAjB;AACAH,IAAAA,EAAE,CAAC5D,YAAH,CAAgB,0BAAhB,EAA4C,EAA5C;AACD;AAOD,WAASgF,uBAAT,CAAiCpB,EAAjC,EAAqC;AACnC,QAAI,CAACA,EAAE,CAACS,YAAH,CAAgB,0BAAhB,CAAL,EAAkD;AAChD;AACD;AACDT,IAAAA,EAAE,CAACE,SAAH,CAAamB,MAAb,CAAoB,eAApB;AACArB,IAAAA,EAAE,CAACzD,eAAH,CAAmB,0BAAnB;AACD;AAUD,WAAS+E,SAAT,CAAmBC,CAAnB,EAAsB;AACpB,QAAIA,CAAC,CAACC,OAAF,IAAaD,CAAC,CAACE,MAAf,IAAyBF,CAAC,CAACG,OAA/B,EAAwC;AACtC;AACD;AAED,QAAIV,kBAAkB,CAACzH,QAAQ,CAACoI,aAAV,CAAlB,IAA8ChB,MAAM,CAACQ,QAAP,CAAgB5H,QAAQ,CAACoI,aAAzB,CAAlD,EAA2F;AACzFT,MAAAA,oBAAoB,CAAC3H,QAAQ,CAACoI,aAAV,CAApB;AACD;AAEDd,IAAAA,gBAAgB,GAAG,IAAnB;AACD;AAUD,WAASe,aAAT,GAAyB;AACvBf,IAAAA,gBAAgB,GAAG,KAAnB;AACD;AASD,WAASgB,OAAT,CAAiBN,CAAjB,EAAoB;AAElB,QAAI,CAACP,kBAAkB,CAACO,CAAC,CAACO,MAAH,CAAvB,EAAmC;AACjC;AACD;AAED,QAAIjB,gBAAJ,EAAsB;AACpBK,MAAAA,oBAAoB,CAACK,CAAC,CAACO,MAAH,CAApB;AACD;AACF;AAMD,WAASC,MAAT,CAAgBR,CAAhB,EAAmB;AACjB,QAAI,CAACP,kBAAkB,CAACO,CAAC,CAACO,MAAH,CAAvB,EAAmC;AACjC;AACD;AAED,QACEP,CAAC,CAACO,MAAF,CAAS5B,SAAT,CAAmBiB,QAAnB,CAA4B,eAA5B,KACAI,CAAC,CAACO,MAAF,CAASrB,YAAT,CAAsB,0BAAtB,CAFF,EAGE;AAKAK,MAAAA,uBAAuB,GAAG,IAA1B;AACAkB,MAAAA,MAAM,CAACC,YAAP,CAAoBlB,8BAApB;AACAA,MAAAA,8BAA8B,GAAGiB,MAAM,CAACE,UAAP,CAAkB,YAAY;AAC7DpB,QAAAA,uBAAuB,GAAG,KAA1B;AACD,OAFgC,EAE9B,GAF8B,CAAjC;AAGAM,MAAAA,uBAAuB,CAACG,CAAC,CAACO,MAAH,CAAvB;AACD;AACF;AAOD,WAASK,kBAAT,GAA8B;AAC5B,QAAI5I,QAAQ,CAAC6I,eAAT,KAA6B,QAAjC,EAA2C;AAKzC,UAAItB,uBAAJ,EAA6B;AAC3BD,QAAAA,gBAAgB,GAAG,IAAnB;AACD;AACDwB,MAAAA,8BAA8B;AAC/B;AACF;AACD,WAASA,8BAAT,GAA0C;AACxC1B,IAAAA,MAAM,CAAC2B,gBAAP,CAAwB,WAAxB,EAAqCC,oBAArC;AACA5B,IAAAA,MAAM,CAAC2B,gBAAP,CAAwB,WAAxB,EAAqCC,oBAArC;AACA5B,IAAAA,MAAM,CAAC2B,gBAAP,CAAwB,SAAxB,EAAmCC,oBAAnC;AACA5B,IAAAA,MAAM,CAAC2B,gBAAP,CAAwB,aAAxB,EAAuCC,oBAAvC;AACA5B,IAAAA,MAAM,CAAC2B,gBAAP,CAAwB,aAAxB,EAAuCC,oBAAvC;AACA5B,IAAAA,MAAM,CAAC2B,gBAAP,CAAwB,WAAxB,EAAqCC,oBAArC;AACA5B,IAAAA,MAAM,CAAC2B,gBAAP,CAAwB,WAAxB,EAAqCC,oBAArC,EAA2D3B,eAAe,GAAG;AAAE4B,MAAAA,OAAO,EAAE;AAAX,KAAH,GAAuB,KAAjG;AACA7B,IAAAA,MAAM,CAAC2B,gBAAP,CAAwB,YAAxB,EAAsCC,oBAAtC,EAA4D3B,eAAe,GAAG;AAAE4B,MAAAA,OAAO,EAAE;AAAX,KAAH,GAAuB,KAAlG;AACA7B,IAAAA,MAAM,CAAC2B,gBAAP,CAAwB,UAAxB,EAAoCC,oBAApC,EAA0D3B,eAAe,GAAG;AAAE4B,MAAAA,OAAO,EAAE;AAAX,KAAH,GAAuB,KAAhG;AACD;AAED,WAASC,iCAAT,CAA2CzC,EAA3C,EAA+C;AAC7CW,IAAAA,MAAM,CAAC+B,mBAAP,CAA2B,WAA3B,EAAwCH,oBAAxC;AACA5B,IAAAA,MAAM,CAAC+B,mBAAP,CAA2B,WAA3B,EAAwCH,oBAAxC;AACA5B,IAAAA,MAAM,CAAC+B,mBAAP,CAA2B,SAA3B,EAAsCH,oBAAtC;AACA5B,IAAAA,MAAM,CAAC+B,mBAAP,CAA2B,aAA3B,EAA0C1C,EAA1C;AACAW,IAAAA,MAAM,CAAC+B,mBAAP,CAA2B,aAA3B,EAA0CH,oBAA1C;AACA5B,IAAAA,MAAM,CAAC+B,mBAAP,CAA2B,WAA3B,EAAwCH,oBAAxC;AACA5B,IAAAA,MAAM,CAAC+B,mBAAP,CAA2B,WAA3B,EAAwCH,oBAAxC,EAA8D3B,eAAe,GAAG;AAAE4B,MAAAA,OAAO,EAAE;AAAX,KAAH,GAAuB,KAApG;AACA7B,IAAAA,MAAM,CAAC+B,mBAAP,CAA2B,YAA3B,EAAyCH,oBAAzC,EAA+D3B,eAAe,GAAG;AAAE4B,MAAAA,OAAO,EAAE;AAAX,KAAH,GAAuB,KAArG;AACA7B,IAAAA,MAAM,CAAC+B,mBAAP,CAA2B,UAA3B,EAAuCH,oBAAvC,EAA6D3B,eAAe,GAAG;AAAE4B,MAAAA,OAAO,EAAE;AAAX,KAAH,GAAuB,KAAnG;AACD;AAQD,WAASD,oBAAT,GAAgC;AAC9B1B,IAAAA,gBAAgB,GAAG,KAAnB;AACA4B,IAAAA,iCAAiC;AAClC,GAhLyD;AAqL1D9B,EAAAA,MAAM,CAAC2B,gBAAP,CAAwB,SAAxB,EAAmChB,SAAnC,EAA8C,IAA9C;AACAX,EAAAA,MAAM,CAAC2B,gBAAP,CAAwB,WAAxB,EAAqCV,aAArC,EAAoD,IAApD;AACAjB,EAAAA,MAAM,CAAC2B,gBAAP,CAAwB,aAAxB,EAAuCV,aAAvC,EAAsD,IAAtD;AACAjB,EAAAA,MAAM,CAAC2B,gBAAP,CAAwB,YAAxB,EAAsCV,aAAtC,EAAqDhB,eAAe,GAAG;AAAE4B,IAAAA,OAAO,EAAE,IAAX;AAAiBG,IAAAA,OAAO,EAAE;AAA1B,GAAH,GAAsC,IAA1G;AACAhC,EAAAA,MAAM,CAAC2B,gBAAP,CAAwB,kBAAxB,EAA4CH,kBAA5C,EAAgE,IAAhE;AAEAE,EAAAA,8BAA8B,GA3L4B;AAiM1D1B,EAAAA,MAAM,CAAC2B,gBAAP,CAAwB,OAAxB,EAAiCT,OAAjC,EAA0C,IAA1C;AACAlB,EAAAA,MAAM,CAAC2B,gBAAP,CAAwB,MAAxB,EAAgCP,MAAhC,EAAwC,IAAxC;AAEApB,EAAAA,MAAM,CAACT,SAAP,CAAiBC,GAAjB,CAAqB,kBAArB;AACD,CCrMD,IAAIyC,MAAJ;AAAA,IAAYC,QAAQ,GAAG,IAAvB;AAAA,IAA6BC,QAAQ,GAAG,IAAxC;AAEe,MAAMC,EAAN,CAAS;AACtBC,EAAAA,WAAW,CAACvG,OAAD,EAAU;AACnB,SAAKwG,OAAL,GAAe,KAAf;AACA,QAAI,CAAC1J,QAAQ,CAACC,aAAT,CAAuB,YAAvB,CAAL,EAA2C;AACzC,WAAK0J,KAAL,GAAapD,aAAa,CAAC;AACzBG,QAAAA,SAAS,EAAE,WADc;AAEzBK,QAAAA,SAAS,EAAE6C;AAFc,OAAD,CAA1B;AAID;AACD,SAAKC,MAAL;AACA,SAAKC,WAAL,CAAiB5G,OAAjB;AACD;AAEK2G,EAAAA,MAAN,GAAe;AAAA;AAAA;AACb,MAAA,KAAI,CAACpD,EAAL,GAAUF,aAAa,CAAC;AACtBG,QAAAA,SAAS,EAAE,CAAC,KAAD,EAAQ,UAAR,CADW;AAEtBG,QAAAA,KAAK,EAAE;AACL,uBAAa;AADR,SAFe;AAKtBE,QAAAA,SAAS,EAAEgD;AALW,OAAD,CAAvB;AAOA,MAAA,KAAI,CAACC,OAAL,GAAe,KAAI,CAACvD,EAAL,CAAQxG,aAAR,CAAsB,iBAAtB,CAAf;AACA,MAAA,KAAI,CAACgK,MAAL,GAAc,KAAI,CAACxD,EAAL,CAAQxG,aAAR,CAAsB,kBAAtB,CAAd;AACA,MAAA,KAAI,CAACiK,MAAL,GAAc,KAAI,CAACzD,EAAL,CAAQxG,aAAR,CAAsB,mBAAtB,CAAd;AACA,MAAA,KAAI,CAACkK,QAAL,GAAgB,KAAI,CAAC1D,EAAL,CAAQxG,aAAR,CAAsB,gBAAtB,CAAhB;AACA,MAAA,KAAI,CAACmK,OAAL,GAAe,KAAI,CAAC3D,EAAL,CAAQxG,aAAR,CAAsB,eAAtB,CAAf;AACA,MAAA,KAAI,CAACoK,OAAL,GAAe,KAAI,CAAC5D,EAAL,CAAQxG,aAAR,CAAsB,iBAAtB,CAAf;AACA,MAAA,KAAI,CAACqK,aAAL,GAAqB,KAAI,CAAC7D,EAAL,CAAQxG,aAAR,CAAsB,qBAAtB,CAArB;AACA,MAAA,KAAI,CAACsK,KAAL,GAAa,KAAI,CAAC9D,EAAL,CAAQxG,aAAR,CAAsB,WAAtB,CAAb;AACA,MAAA,KAAI,CAACiB,MAAL,GAAc,KAAI,CAACuF,EAAL,CAAQxG,aAAR,CAAsB,aAAtB,CAAd;AACA,MAAA,KAAI,CAACuK,UAAL,GAAkB,KAAI,CAAC/D,EAAL,CAAQxG,aAAR,CAAsB,kBAAtB,CAAlB;AACA,MAAA,KAAI,CAACwK,SAAL,GAAiB,KAAI,CAAChE,EAAL,CAAQxG,aAAR,CAAsB,iBAAtB,CAAjB;AACA,MAAA,KAAI,CAACyK,UAAL,GAAkB,KAAI,CAACjE,EAAL,CAAQxG,aAAR,CAAsB,kBAAtB,CAAlB;AACA,MAAA,KAAI,CAACgB,KAAL,GAAa,KAAI,CAACwF,EAAL,CAAQxG,aAAR,CAAsB,YAAtB,CAAb;AACA,MAAA,KAAI,CAAC0K,WAAL,GAAmB,KAAI,CAAClE,EAAL,CAAQxG,aAAR,CAAsB,eAAtB,CAAnB;AACA,MAAA,KAAI,CAACkB,QAAL,GAAgB,KAAI,CAACsF,EAAL,CAAQxG,aAAR,CAAsB,oBAAtB,CAAhB;AACA,MAAA,KAAI,CAAC2K,GAAL,GAAW,KAAI,CAACnE,EAAL,CAAQxG,aAAR,CAAsB,UAAtB,CAAX;AACA,MAAA,KAAI,CAAC4K,OAAL,GAAe,KAAI,CAACpE,EAAL,CAAQxG,aAAR,CAAsB,eAAtB,CAAf;AACA,MAAA,KAAI,CAAC6K,WAAL,GAAmB,KAAI,CAACrE,EAAL,CAAQxG,aAAR,CAAsB,iBAAtB,CAAnB;AACA,MAAA,KAAI,CAAC8K,WAAL,GAAmB,KAAI,CAACtE,EAAL,CAAQxG,aAAR,CAAsB,iBAAtB,CAAnB;AACA,MAAA,KAAI,CAAC+K,MAAL,GAAc,KAAI,CAACvE,EAAL,CAAQxG,aAAR,CAAsB,iBAAtB,CAAd;AACA,MAAA,KAAI,CAACoB,KAAL,GAAa,KAAI,CAACoF,EAAL,CAAQxG,aAAR,CAAsB,YAAtB,CAAb;AACA,MAAA,KAAI,CAACgL,YAAL,GAAoB,CAClB,KAAI,CAAChB,MADa,EAElB,KAAI,CAACC,MAFa,EAGlB,KAAI,CAACc,MAHa,CAApB;AA7Ba;AAkCd;AAEDlB,EAAAA,WAAW,CAAC5G,OAAD,EAAU;AAGnB,SAAKuD,EAAL,CAAQ3D,KAAR,8BAAoCI,OAAO,CAAC3C,UAA5C;AACA,SAAKkG,EAAL,CAAQ5D,YAAR,CAAqB,YAArB,EAAmCK,OAAO,CAAC1C,KAA3C,EAJmB;AAOnB,QAAI0C,OAAO,CAAC5C,QAAR,IAAoB4C,OAAO,CAACrC,KAA5B,IAAqCqC,OAAO,CAACrC,KAAR,CAAcU,GAAvD,EAA4D;AAC1D,WAAK2J,WAAL,GAAmB3E,aAAa,CAAC;AAC/BC,QAAAA,GAAG,EAAE,GAD0B;AAE/BE,QAAAA,SAAS,EAAE,CAAC,SAAD,EAAY,kBAAZ,CAFoB;AAG/BG,QAAAA,KAAK,EAAE;AACL5F,UAAAA,KAAK,EAAE,UADF;AAEL,wBAAc,UAFT;AAGLkK,UAAAA,IAAI,EAAE,OAAOjI,OAAO,CAAC5C,QAAf,KAA4B,QAA5B,GAAuC4C,OAAO,CAAC5C,QAA/C,GAA0D4C,OAAO,CAACrC,KAAR,CAAcU,GAHzE;AAILjB,UAAAA,QAAQ,EAAE,EAJL;AAKLiI,UAAAA,MAAM,EAAE,QALH;AAML6C,UAAAA,GAAG,EAAE;AANA,SAHwB;AAW/BrE,QAAAA,SAAS;AAAA;AAXsB,OAAD,CAAhC;AAiBA,WAAKuD,aAAL,CAAmBe,MAAnB,CAA0B,KAAKH,WAA/B;AACD,KA1BkB;AA6BnB,SAAKzE,EAAL,CAAQ5D,YAAR,CAAqB,iBAArB,EAAwCK,OAAO,CAAC/C,KAAR,CAAcC,IAAtD;AACA,QAAI8C,OAAO,CAAC/C,KAAR,CAAcC,IAAd,KAAuB,QAAvB,IAAmC8C,OAAO,CAAC/C,KAAR,CAAcE,QAAd,KAA2B,KAAlE,EAAyE;AACvE,WAAKoG,EAAL,CAAQ5D,YAAR,CAAqB,gBAArB,EAAuCK,OAAO,CAAC/C,KAAR,CAAcE,QAArD;AACD,KAhCkB;AAmCnB,QAAMiL,UAAU,GAAGpI,OAAO,CAACzC,QAAR,GAAmB,SAAnB,GAA+B,QAAlD;AACA,SAAKgG,EAAL,CAAQ5D,YAAR,CAAqB,WAArB,EAAkCyI,UAAlC,EApCmB;AAuCnB,QAAIpI,OAAO,CAACxC,KAAZ,EAAmB;AACjB,WAAK+F,EAAL,CAAQ5D,YAAR,CAAqB,WAArB,EAAkC,EAAlC;AACD;AACF;AAED0I,EAAAA,UAAU,CAAClE,eAAD,EAAkB;AAC1B,SAAK+C,OAAL,CAAarB,gBAAb,CAA8B,OAA9B,EAAuC,MAAM;AAC3C/B,MAAAA,eAAe,CAAC,KAAKP,EAAN,EAAU,YAAV,CAAf;AACD,KAFD;AAGA7C,IAAAA,KAAK,CAAC4H,IAAN,CAAW,KAAKlB,aAAL,CAAmBmB,QAA9B,EAAwClI,OAAxC,CAAgDkD,EAAE,IAAI;AACpD,WAAKiF,gBAAL,CAAsBjF,EAAtB;AACD,KAFD,EAJ0B;AAS1BkF,IAAAA,yBAAiB,CAAC,KAAKlF,EAAN,EAAUY,eAAV,CAAjB;AAEAgC,IAAAA,MAAM,GAAG,MAAM;AACb,UAAI,CAACE,QAAL,EAAe;AACfA,MAAAA,QAAQ,GAAG,KAAX;AACAZ,MAAAA,UAAU,CAAC,MAAMY,QAAQ,GAAG,IAAlB,EAAwB,GAAxB,CAAV;AACAhH,MAAAA,OAAO,CAACqJ,IAAR,CAAa,IAAb,EAAmB,KAAKnB,SAAxB,EAAmC,KAAKxJ,KAAxC;AACD,KALD;AAMAwH,IAAAA,MAAM,CAACM,gBAAP,CAAwB,QAAxB,EAAkCM,MAAlC;AACD;AAEDwC,EAAAA,YAAY,GAAa;AAAA,QAAZhL,KAAY,uEAAJ,EAAI;AACvB,QAAIyI,QAAJ,EAAc;AACZzD,MAAAA,GAAG,CAACiG,eAAJ,CAAoBxC,QAApB;AACAA,MAAAA,QAAQ,GAAG,IAAX;AACD;AACD,QAAI,OAAOyC,IAAP,CAAYlL,KAAK,CAACQ,KAAlB,CAAJ,EAA8B;AAC5BiI,MAAAA,QAAQ,GAAGzI,KAAK,CAACQ,KAAjB;AACD;AACD,QAAIR,KAAK,CAACQ,KAAV,EAAiB;AACf,WAAKA,KAAL,CAAWyB,KAAX,CAAiBkJ,eAAjB,iBAA0CnL,KAAK,CAACQ,KAAhD;AACD,KAFD,MAEO;AACL,WAAKA,KAAL,CAAWyB,KAAX,CAAiBkJ,eAAjB,GAAmC,MAAnC;AACD;AACD,SAAK/K,KAAL,CAAW8F,SAAX,GAAuBlG,KAAK,CAACI,KAA7B;AACA,SAAKyJ,UAAL,CAAgB7H,YAAhB,CAA6B,YAA7B,EAA2ChC,KAAK,CAACI,KAAjD;AACA,SAAKC,MAAL,CAAY6F,SAAZ,GAAwBlG,KAAK,CAACK,MAA9B;AACA,QAAIL,KAAK,CAACM,QAAV,EAAoB;AAClB,WAAKA,QAAL,CAAc4F,SAAd,GAA0BtF,YAAY,CAACZ,KAAK,CAACM,QAAP,CAAtC;AACD;AACD,QAAI,KAAK+J,WAAT,EAAsB;AACpB,WAAKA,WAAL,CAAiBC,IAAjB,GAAuBtK,KAAK,CAACU,GAA7B;AACD;AACD,SAAK0K,MAAL,CAAY,QAAZ,EAAsB,CAAtB;AACD;AAEDC,EAAAA,UAAU,GAAG;AACX,SAAKzF,EAAL,CAAQ5D,YAAR,CAAqB,WAArB,EAAkC,SAAlC;AACD;AAEDsJ,EAAAA,SAAS,GAAG;AACV,SAAK1F,EAAL,CAAQ5D,YAAR,CAAqB,WAArB,EAAkC,QAAlC;AACA,SAAK4D,EAAL,CAAQzD,eAAR,CAAwB,cAAxB;AACD;AAEDoJ,EAAAA,OAAO,CAAChM,IAAD,EAAOsB,IAAP,EAAa;AAClB,SAAKtB,IAAL,EAAW2G,SAAX,GAAuBtF,YAAY,CAACC,IAAD,CAAnC;AACD;AAEDuK,EAAAA,MAAM,CAAC7L,IAAD,EAAOiM,UAAP,EAAmB;AACvB,QAAMC,QAAQ,GAAG,UAAUlM,IAAI,CAACmM,MAAL,CAAY,CAAZ,EAAeC,WAAf,EAAV,GAAyCpM,IAAI,CAACqM,MAAL,CAAY,CAAZ,CAA1D;AACAJ,IAAAA,UAAU,GAAG1K,IAAI,CAACI,GAAL,CAASsK,UAAT,EAAqB,CAArB,CAAb;AACAA,IAAAA,UAAU,GAAG1K,IAAI,CAAC+K,GAAL,CAASL,UAAT,EAAqB,CAArB,CAAb;AACA,SAAKC,QAAL,EAAexJ,KAAf,CAAqB6J,KAArB,GAA6BN,UAAU,GAAG,GAAb,GAAmB,GAAhD;AACA,QAAMO,OAAO,GAAGP,UAAU,CAAChK,OAAX,CAAmB,CAAnB,CAAhB;AACA,SAAKiK,QAAL,EAAezJ,YAAf,CAA4B,eAA5B,EAA6C+J,OAA7C;AACA,SAAK5B,MAAL,CAAYnI,YAAZ,CAAyB,eAAzB,EAA0C+J,OAA1C;AACD;AAEDC,EAAAA,WAAW,GAAyC;AAAA,QAAxCnL,IAAwC,uEAAjC,CAAiC;AAAA,QAA9B2K,UAA8B,uEAAjB,CAAiB;AAAA,QAAdlL,QAAc,uEAAH,CAAG;AAClD,QAAIO,IAAI,IAAI,CAAC2K,UAAb,EAAyB;AACvBA,MAAAA,UAAU,GAAGlL,QAAQ,GAAGO,IAAI,GAAGP,QAAV,GAAqB,CAA1C;AACD,KAFD,MAEO;AACLO,MAAAA,IAAI,GAAG2K,UAAU,IAAIlL,QAAQ,IAAI,CAAhB,CAAjB;AACD;AACD,SAAKiL,OAAL,CAAa,aAAb,EAA4B1K,IAA5B;AACA,SAAKuK,MAAL,CAAY,QAAZ,EAAsBI,UAAtB;AACD;AAEDS,EAAAA,QAAQ,CAACpK,KAAD,EAAQ;AACd,SAAKyH,QAAL,CAAcpD,SAAd,GAA0B9E,WAAW,CAACS,KAAD,CAAX,GAAqB,GAA/C;AACD;AAEDqK,EAAAA,eAAe,CAAC/E,CAAD,EAAI;AACjB,QAAMgF,SAAS,GAAGhF,CAAC,CAACiF,OAAF,IAAcjF,CAAC,CAACkF,cAAF,IAAoBlF,CAAC,CAACkF,cAAF,CAAiB,CAAjB,EAAoBD,OAAtD,IAAkE,CAApF;AACA,QAAME,OAAO,GAAG,KAAKtC,OAAL,CAAauC,qBAAb,GAAqCC,IAArD;AACA,QAAMC,SAAS,GAAG,KAAKzC,OAAL,CAAa0C,WAA/B;AACA,QAAIlB,UAAU,GAAG,CAACW,SAAS,GAAGG,OAAb,IAAwBG,SAAzC;AACAjB,IAAAA,UAAU,GAAG1K,IAAI,CAACI,GAAL,CAASsK,UAAT,EAAqB,CAArB,CAAb;AACAA,IAAAA,UAAU,GAAG1K,IAAI,CAAC+K,GAAL,CAAS,CAAT,EAAYL,UAAZ,CAAb;AACA,WAAOA,UAAP;AACD;AAEDX,EAAAA,gBAAgB,CAACjF,EAAD,EAAK;AACnBA,IAAAA,EAAE,CAACsC,gBAAH,CAAoB,OAApB,EAA6B,MAAM;AACjCJ,MAAAA,UAAU,CAAC,MAAM;AACf,aAAKlC,EAAL,CAAQzD,eAAR,CAAwB,YAAxB;AACD,OAFS,EAEP,GAFO,CAAV;AAGD,KAJD;AAKD;AAEDwK,EAAAA,KAAK,CAACzN,SAAD,EAAYsH,eAAZ,EAA6B;AAChCtH,IAAAA,SAAS,CAACgH,SAAV,GAAsB,EAAtB;AACAhH,IAAAA,SAAS,CAACsL,MAAV,CAAiB,KAAK5E,EAAtB;AACA,QAAI,KAAKkD,KAAT,EAAgB;AACd5J,MAAAA,SAAS,CAACsL,MAAV,CAAiB,KAAK1B,KAAtB;AACD;AACD,SAAKD,OAAL,GAAe,IAAf;AACA,SAAK6B,UAAL,CAAgBlE,eAAhB;AACA9E,IAAAA,OAAO,CAAC,KAAKkI,SAAN,EAAiB,KAAKxJ,KAAtB,CAAP;AACD;AAEDwM,EAAAA,OAAO,GAAG;AACRhF,IAAAA,MAAM,CAACU,mBAAP,CAA2B,QAA3B,EAAqCE,MAArC;AACA,QAAIC,QAAJ,EAAc;AACZzD,MAAAA,GAAG,CAACiG,eAAJ,CAAoBxC,QAApB;AACD;AACF;AAjNqB,CCPT,MAAMoE,MAAN,CAAa;AAC1BjE,EAAAA,WAAW,GAAG;AACZ,SAAKkE,WAAL,GAAmB,CAAC,OAAD,EAAU,SAAV,EAAqB,gBAArB,EAAuC,UAAvC,EAAmD,gBAAnD,EAAqE,SAArE,EAAgF,OAAhF,EAAyF,OAAzF,EAAkG,YAAlG,EAAgH,gBAAhH,EAAkI,WAAlI,EAA+I,OAA/I,EAAwJ,MAAxJ,EAAgK,SAAhK,EAA2K,UAA3K,EAAuL,YAAvL,EAAqM,QAArM,EAA+M,SAA/M,EAA0N,SAA1N,EAAqO,SAArO,EAAgP,YAAhP,EAA8P,cAA9P,EAA8Q,SAA9Q,CAAnB;AACA,SAAKC,YAAL,GAAoB,CAAC,aAAD,EAAgB,YAAhB,CAApB;AACA,SAAKC,MAAL,GAAc,EAAd;AACD;AAEDC,EAAAA,EAAE,CAAC7G,IAAD,EAAO8G,QAAP,EAAiB;AACjB,QAAI,KAAK3N,IAAL,CAAU6G,IAAV,KAAmB,OAAO8G,QAAP,IAAmB,UAA1C,EAAsD;AACpD,UAAI,CAAC,KAAKF,MAAL,CAAY5G,IAAZ,CAAL,EAAwB;AACtB,aAAK4G,MAAL,CAAY5G,IAAZ,IAAoB,EAApB;AACD;AACD,WAAK4G,MAAL,CAAY5G,IAAZ,EAAkBlD,IAAlB,CAAuBgK,QAAvB;AACD;AACF;AAEDC,EAAAA,OAAO,CAAC/G,IAAD,EAAkB;AAAA,QAAX1B,IAAW,uEAAJ,EAAI;AACvB,QAAI,KAAKsI,MAAL,CAAY5G,IAAZ,KAAqB,KAAK4G,MAAL,CAAY5G,IAAZ,EAAkB7C,MAA3C,EAAmD;AACjD,WAAKyJ,MAAL,CAAY5G,IAAZ,EAAkB1D,OAAlB,CAA0B0K,EAAE,IAAIA,EAAE,CAAC1I,IAAD,CAAlC;AACD;AACF;AAEDnF,EAAAA,IAAI,CAAC6G,IAAD,EAAO;AACT,QAAI,KAAK2G,YAAL,CAAkB9J,OAAlB,CAA0BmD,IAA1B,MAAoC,CAAC,CAAzC,EAA4C;AAC1C,aAAO,QAAP;AACD,KAFD,MAEO,IAAI,KAAK0G,WAAL,CAAiB7J,OAAjB,CAAyBmD,IAAzB,MAAmC,CAAC,CAAxC,EAA2C;AAChD,aAAO,OAAP;AACD;AACDiH,IAAAA,OAAO,CAACC,KAAR,yCAA+ClH,IAA/C;AACA,WAAO,IAAP;AACD;AA9ByB,CCI5B,IAAMmH,SAAS,GAAG,EAAlB;AACA,IAAMC,gBAAgB,GAAG,EAAzB;AACA,IAAMC,QAAQ,GAAG,OAAO7F,MAAP,KAAkB,WAAlB,GAAgC,UAAUsD,IAAV,CAAetD,MAAM,CAAC8F,SAAP,CAAiBC,SAAhC,CAAhC,GAA6E,KAA9F;AACA,IAAMC,SAAS,GAAGH,QAAQ,GAAG,YAAH,GAAkB,WAA5C;AACA,IAAMI,QAAQ,GAAGJ,QAAQ,GAAG,WAAH,GAAiB,WAA1C;AACA,IAAMK,OAAO,GAAGL,QAAQ,GAAG,UAAH,GAAgB,SAAxC;AAGA,IAAIjH,eAAe,GAAG,KAAtB;AACA,IAAI,OAAOoB,MAAP,KAAkB,WAAtB,EAAmC;AACjC,MAAI;AACF,QAAMmG,IAAI,GAAGxL,MAAM,CAACyL,cAAP,CAAsB,EAAtB,EAA0B,SAA1B,EAAqC;AAChDC,MAAAA,GAAG,EAAE,eAAY;AACfzH,QAAAA,eAAe,GAAG,IAAlB;AACA,eAAO,KAAP;AACD;AAJ+C,KAArC,CAAb;AAMAoB,IAAAA,MAAM,CAACM,gBAAP,CAAwB,aAAxB,EAAuC,IAAvC,EAA6C6F,IAA7C;AACAnG,IAAAA,MAAM,CAACU,mBAAP,CAA2B,aAA3B,EAA0C,IAA1C,EAAgDyF,IAAhD;AACD,GATD,CASE,OAAO5G,CAAP,EAAU;AACVX,IAAAA,eAAe,GAAG,KAAlB;AACD;AACF;AACD,IAAM0H,UAAU,GAAG1H,eAAe,IAAIiH,QAAtC;AAEA,MAAMU,MAAN,CAAa;AACXvF,EAAAA,WAAW,CAACvG,OAAD,EAAU;AACnB,SAAKgD,EAAL,GAAUkI,SAAS,CAAChK,MAApB;AACAgK,IAAAA,SAAS,CAACrK,IAAV,CAAe,IAAf;AACA,SAAKkL,KAAL,GAAa,EAAb;AACA,SAAKC,MAAL,GAAc,EAAd;AACA,SAAKC,gBAAL,GAAwB,KAAxB;AACA,SAAKC,SAAL,GAAiB,CAAjB;AACA,SAAKC,QAAL,GAAgB,KAAhB;AACA,SAAKC,SAAL,GAAiB,KAAjB;AACA,SAAKzB,MAAL,GAAc,IAAIH,MAAJ,EAAd;AACA,SAAKxK,OAAL,GAAeD,aAAa,CAACC,OAAD,CAA5B;AACA,SAAKqM,gBAAL;AACA,SAAKC,MAAL,CAAY,KAAKtM,OAAjB;AACA,SAAKuM,SAAL;AACA,SAAKC,EAAL,CAAQlC,KAAR,CAAc,KAAKtK,OAAL,CAAanD,SAA3B,EAAsCsH,eAAtC;AACD;AAID,MAAIlG,QAAJ,GAAe;AACb,QAAI,CAAC,KAAKN,KAAN,IAAe,CAAC,KAAKA,KAAL,CAAWM,QAA/B,EAAyC;AACvC,aAAO,KAAK+N,MAAL,CAAY/N,QAAnB;AACD;AACD,WAAO,KAAKN,KAAL,CAAWM,QAAlB;AACD;AAED,MAAIwO,QAAJ,GAAe;AACb,WAAOC,OAAO,CAAC,KAAKzO,QAAN,CAAd;AACD;AAED,MAAIwO,QAAJ,CAAaE,CAAb,EAAgB;AACd,QAAIA,CAAJ,EAAO;AACL,WAAKH,EAAL,CAAQzE,YAAR,CAAqB1H,OAArB,CAA6BkD,EAAE,IAAI;AACjCA,QAAAA,EAAE,CAACzD,eAAH,CAAmB,UAAnB;AACD,OAFD;AAGD,KAJD,MAIO;AACL,WAAK0M,EAAL,CAAQzE,YAAR,CAAqB1H,OAArB,CAA6BkD,EAAE,IAAI;AACjCA,QAAAA,EAAE,CAAC5D,YAAH,CAAgB,UAAhB,EAA4B,EAA5B;AACD,OAFD;AAGD;AACF;AAED,MAAI8H,WAAJ,GAAkB;AAChB,WAAO,KAAK9J,KAAL,GAAa,KAAKA,KAAL,CAAW8J,WAAxB,GAAsCmF,SAA7C;AACD;AAED,MAAIC,YAAJ,GAAmB;AACjB,WAAO,KAAKlP,KAAL,GAAa,KAAKA,KAAL,CAAWkP,YAAxB,GAAuCD,SAA9C;AACD;AAED,MAAIC,YAAJ,CAAiBF,CAAjB,EAAoB;AAClB,QAAI,KAAKhP,KAAT,EAAgB;AACd,WAAKA,KAAL,CAAWkP,YAAX,GAA0BF,CAA1B;AACA,WAAKhP,KAAL,CAAWmP,mBAAX,GAAiCH,CAAjC;AACD;AACF;AAED,MAAInP,KAAJ,GAAY;AACV,WAAO,KAAKG,KAAL,GAAa,KAAKA,KAAL,CAAWH,KAAxB,GAAgCoP,SAAvC;AACD;AAED,MAAIpP,KAAJ,CAAUmP,CAAV,EAAa;AACX,QAAI,KAAKhP,KAAT,EAAgB;AACd,WAAKA,KAAL,CAAWH,KAAX,GAAmBmP,CAAnB;AACA,WAAKhP,KAAL,CAAWoP,YAAX,GAA0BJ,CAA1B;AACD;AACF;AAEDL,EAAAA,MAAM,GAAG;AACP,SAAKE,EAAL,GAAU,IAAIlG,EAAJ,CAAO,KAAKtG,OAAZ,CAAV;AACA,SAAKuD,EAAL,GAAU,KAAKiJ,EAAL,CAAQjJ,EAAlB;AACA,SAAKyJ,iBAAL;AACA,SAAKC,aAAL;AACD;AAEDD,EAAAA,iBAAiB,GAAG;AAClB,SAAKR,EAAL,CAAQ1F,OAAR,CAAgBjB,gBAAhB,CAAiC,OAAjC,EAA0C,MAAM;AAC9C,WAAKqH,MAAL;AACD,KAFD;AAGA,SAAKV,EAAL,CAAQrF,OAAR,CAAgBtB,gBAAhB,CAAiC,OAAjC,EAA0C,MAAM;AAC9C,WAAKrI,KAAL,GAAa,CAAC,KAAKA,KAAnB;AACAsG,MAAAA,eAAe,CAAC,KAAKP,EAAN,EAAU,WAAV,CAAf;AACD,KAHD;AAIA,SAAKiJ,EAAL,CAAQzF,MAAR,CAAelB,gBAAf,CAAgC,OAAhC,EAAyC,MAAM;AAC7C,WAAKsH,UAAL;AACD,KAFD;AAGA,SAAKX,EAAL,CAAQxF,MAAR,CAAenB,gBAAf,CAAgC,OAAhC,EAAyC,MAAM;AAC7C,WAAKsH,UAAL,CAAgB;AAAEC,QAAAA,OAAO,EAAE;AAAX,OAAhB;AACD,KAFD;AAGA,SAAKZ,EAAL,CAAQvF,QAAR,CAAiBpB,gBAAjB,CAAkC,OAAlC,EAA2C,MAAM;AAC/C,UAAMwH,KAAK,GAAG,KAAKrN,OAAL,CAAatC,YAAb,CAA0BkD,OAA1B,CAAkC,KAAKiM,YAAvC,CAAd;AACA,UAAMS,UAAU,GAAG,KAAKtN,OAAL,CAAatC,YAAhC;AACA,WAAKmP,YAAL,GAAqBQ,KAAK,GAAG,CAAR,IAAaC,UAAU,CAACpM,MAAzB,GAAmCoM,UAAU,CAAC,CAAD,CAA7C,GAAmDA,UAAU,CAACD,KAAK,GAAG,CAAT,CAAjF;AACA,WAAKb,EAAL,CAAQ5C,QAAR,CAAiB,KAAKiD,YAAtB;AACD,KALD;AAMD;AAEDI,EAAAA,aAAa,GAAG;AACd,QAAIM,UAAU,GAAG,CAAjB;AACA,QAAMC,gBAAgB,GAAI1I,CAAD,IAAO;AAC9B,UAAI,CAAC,KAAK2H,QAAV,EAAoB;AACpB3H,MAAAA,CAAC,CAAC2I,cAAF;AACA,WAAKlK,EAAL,CAAQ5D,YAAR,CAAqB,cAArB,EAAqC,EAArC;AACA,WAAKyM,SAAL,GAAiB,IAAjB;AACAtP,MAAAA,QAAQ,CAAC+I,gBAAT,CAA0B2F,QAA1B,EAAoCkC,eAApC,EAAqD7B,UAAU,GAAG;AAAE9F,QAAAA,OAAO,EAAE;AAAX,OAAH,GAAuB,KAAtF;AACAjJ,MAAAA,QAAQ,CAAC+I,gBAAT,CAA0B4F,OAA1B,EAAmCkC,cAAnC;AACD,KAPD;AAQA,QAAMD,eAAe,GAAI5I,CAAD,IAAO;AAC7B,WAAK0H,EAAL,CAAQ7C,WAAR,CAAoB,IAApB,EAA0B,KAAK6C,EAAL,CAAQ3C,eAAR,CAAwB/E,CAAxB,CAA1B,EAAsD,KAAK7G,QAA3D;AACD,KAFD;AAGA,QAAM0P,cAAc,GAAI7I,CAAD,IAAO;AAC5BA,MAAAA,CAAC,CAAC2I,cAAF;AACA3Q,MAAAA,QAAQ,CAACmJ,mBAAT,CAA6BuF,QAA7B,EAAuCkC,eAAvC;AACA5Q,MAAAA,QAAQ,CAACmJ,mBAAT,CAA6BwF,OAA7B,EAAsCkC,cAAtC;AACAJ,MAAAA,UAAU,GAAG,KAAKf,EAAL,CAAQ3C,eAAR,CAAwB/E,CAAxB,IAA6B,KAAK7G,QAA/C;AACA,WAAK2P,IAAL,CAAUL,UAAV;AACA,WAAKnB,SAAL,GAAiB,KAAjB,CAN4B;AAS5B3G,MAAAA,UAAU,CAAC,MAAM,KAAKlC,EAAL,CAAQzD,eAAR,CAAwB,cAAxB,CAAP,EAAgD,EAAhD,CAAV;AACD,KAVD,CAbc;AA0Bd,QAAM+N,cAAc,GAAI/I,CAAD,IAAO;AAC5B,UAAI,CAAC,KAAK2H,QAAV,EAAoB,OADQ;AAI5B,UAAM7I,GAAG,GAAGkB,CAAC,CAAClB,GAAF,CAAMkK,OAAN,CAAc,OAAd,EAAuB,EAAvB,CAAZ;AAEA,UAAMC,YAAY,GAAG,CAAC,MAAD,EAAS,MAAT,CAArB;AACA,UAAMC,WAAW,GAAG,CAAC,OAAD,EAAU,IAAV,CAApB;AACA,UAAMC,aAAa,GAAG,CAAC,UAAD,EAAa,QAAb,CAAtB;AACA,UAAMC,QAAQ,GAAG,CAAC,MAAD,EAAS,KAAT,CAAjB;AACA,UAAMC,MAAM,GAAGJ,YAAY,CAACnN,OAAb,CAAqBgD,GAArB,MAA8B,CAAC,CAA9C;AACA,UAAMwK,KAAK,GAAGJ,WAAW,CAACpN,OAAZ,CAAoBgD,GAApB,MAA6B,CAAC,CAA5C;AACA,UAAMyK,SAAS,GAAGzK,GAAG,KAAKqK,aAAa,CAAC,CAAD,CAAvC;AACA,UAAMK,QAAQ,GAAG1K,GAAG,KAAKqK,aAAa,CAAC,CAAD,CAAtC;AACA,UAAMM,OAAO,GAAG3K,GAAG,KAAKsK,QAAQ,CAAC,CAAD,CAAhC;AACA,UAAMM,KAAK,GAAG5K,GAAG,KAAKsK,QAAQ,CAAC,CAAD,CAA9B;AACA,UAAI,CAACC,MAAD,IAAW,CAACC,KAAZ,IAAqBH,aAAa,CAACrN,OAAd,CAAsBgD,GAAtB,MAA+B,CAAC,CAArD,IAA0DsK,QAAQ,CAACtN,OAAT,CAAiBgD,GAAjB,MAA0B,CAAC,CAAzF,EAA4F;AAC1F;AACD;AACD,UAAI2K,OAAJ,EAAa;AACX,aAAKX,IAAL,CAAU,CAAV;AACA;AACD;AACD,UAAIY,KAAJ,EAAW;AACT,aAAKZ,IAAL,CAAU,KAAK3P,QAAf;AACA;AACD;AACD,UAAMwQ,IAAI,GAAG,CAACH,QAAQ,IAAID,SAAZ,GAAwB,GAAxB,GAA8B,IAA/B,KAAwCD,KAAK,IAAIE,QAAT,GAAoB,CAApB,GAAwB,CAAC,CAAjE,CAAb;AACA,UAAM7G,WAAW,GAAG,KAAK0E,QAAL,GAAgB,KAAK1E,WAArB,GAAmC,KAAKyE,SAA5D;AACA,UAAM1N,IAAI,GAAGiQ,IAAI,GAAG,KAAKxQ,QAAZ,GAAuBwJ,WAApC;AACA,WAAKmG,IAAL,CAAUpP,IAAV;AACD,KA/BD;AAgCA,SAAKgO,EAAL,CAAQ7E,OAAR,CAAgB9B,gBAAhB,CAAiC0F,SAAjC,EAA4CiC,gBAA5C;AACA,SAAKhB,EAAL,CAAQ1E,MAAR,CAAejC,gBAAf,CAAgC,SAAhC,EAA2CgI,cAA3C;AACD;AAEDtB,EAAAA,SAAS,GAAG;AACV,QAAI,KAAKvM,OAAL,CAAarC,KAAb,CAAmBU,GAAvB,EAA4B;AAC1B,WAAKV,KAAL,GAAa,IAAI+Q,KAAJ,EAAb;AACA,WAAKC,eAAL;AACA,WAAKhE,MAAL,CAAYF,WAAZ,CAAwBpK,OAAxB,CAAgC0D,IAAI,IAAI;AACtC,aAAKpG,KAAL,CAAWkI,gBAAX,CAA4B9B,IAA5B,EAAmCe,CAAD,IAAO;AACvC,eAAK6F,MAAL,CAAYG,OAAZ,CAAoB/G,IAApB,EAA0Be,CAA1B;AACD,SAFD;AAGD,OAJD;AAKA,WAAKnH,KAAL,CAAWF,OAAX,GAAqB,KAAKuC,OAAL,CAAavC,OAAlC;AACA,WAAKD,KAAL,GAAa,KAAKwC,OAAL,CAAaxC,KAA1B;AACA,WAAKoR,MAAL,CAAY,KAAK5O,OAAL,CAAarC,KAAzB;AACD;AACF;AAEDgR,EAAAA,eAAe,GAAG;AAChB,SAAK/D,EAAL,CAAQ,MAAR,EAAgB,MAAM;AACpB,WAAK4B,EAAL,CAAQxD,UAAR;AACAkC,MAAAA,SAAS,CAAC7K,OAAV,CAAkBwO,MAAM,IAAI;AAC1B,YAAIA,MAAM,CAAC7L,EAAP,KAAc,KAAKA,EAAnB,IAAyB6L,MAAM,CAAClR,KAAhC,IAAyC,CAACkR,MAAM,CAAClR,KAAP,CAAamR,MAA3D,EAAmE;AACjED,UAAAA,MAAM,CAACE,KAAP;AACD;AACF,OAJD;AAKD,KAPD;AAQA,SAAKnE,EAAL,CAAQ,OAAR,EAAiB,MAAM;AACrB,WAAK4B,EAAL,CAAQvD,SAAR;AACD,KAFD;AAGA,SAAK2B,EAAL,CAAQ,OAAR,EAAiB,MAAM;AACrB,WAAK4B,EAAL,CAAQvD,SAAR;AACA,WAAK2E,IAAL,CAAU,CAAV;AACD,KAHD;AAIA,SAAKhD,EAAL,CAAQ,SAAR,EAAmB,MAAM;AACvB,WAAKrH,EAAL,CAAQ5D,YAAR,CAAqB,cAArB,EAAqC,EAArC;AACD,KAFD;AAGA,SAAKiL,EAAL,CAAQ,gBAAR,EAA0B,MAAM;AAC9B,UAAI,KAAK3M,QAAL,IAAiB,KAAKA,QAAL,KAAkB,CAAvC,EAA0C;AACxC,aAAKwO,QAAL,GAAgB,IAAhB;AACA,aAAKD,EAAL,CAAQtD,OAAR,CAAgB,UAAhB,EAA4B,KAAKjL,QAAjC;AACD;AACF,KALD;AAMA,SAAK2M,EAAL,CAAQ,SAAR,EAAmB,MAAM;AACvB,UAAI,CAAC,KAAKuB,QAAV,EAAoB;AAClB,aAAKA,QAAL,GAAgB,IAAhB;AACA,YAAI,KAAKD,SAAT,EAAoB;AAClB,eAAK0B,IAAL,CAAU,KAAK1B,SAAf;AACA,eAAKA,SAAL,GAAiB,CAAjB;AACD;AACF;AACF,KARD;AASA,SAAKtB,EAAL,CAAQ,gBAAR,EAA0B,MAAM;AAC9B,WAAKrH,EAAL,CAAQzD,eAAR,CAAwB,cAAxB;AACD,KAFD;AAGA,SAAK8K,EAAL,CAAQ,UAAR,EAAoB,MAAM;AACxB,UAAI,KAAKjN,KAAL,CAAWqR,QAAX,CAAoB9N,MAAxB,EAAgC;AAC9B,YAAMiI,UAAU,GAAG,KAAKxL,KAAL,CAAWqR,QAAX,CAAoB9N,MAApB,GAA6B,KAAKvD,KAAL,CAAWqR,QAAX,CAAoBC,GAApB,CAAwB,KAAKtR,KAAL,CAAWqR,QAAX,CAAoB9N,MAApB,GAA6B,CAArD,IAA0D,KAAKjD,QAA5F,GAAuG,CAA1H;AACA,aAAKuO,EAAL,CAAQzD,MAAR,CAAe,QAAf,EAAyBI,UAAzB;AACD;AACF,KALD;AAMA,SAAKyB,EAAL,CAAQ,YAAR,EAAsB,MAAM;AAC1B,UAAI,CAAC,KAAKwB,SAAV,EAAqB;AACnB,aAAKI,EAAL,CAAQ7C,WAAR,CAAoB,KAAKhM,KAAL,CAAW8J,WAA/B,EAA4C,IAA5C,EAAkD,KAAKxJ,QAAvD;AACD;AACF,KAJD;AAKA,SAAK2M,EAAL,CAAQ,OAAR,EAAiB,MAAM;AACrB,WAAK4B,EAAL,CAAQvD,SAAR;AACD,KAFD;AAGD;AAEDiG,EAAAA,gBAAgB,GAAG;AACjB,QAAMC,IAAI,GAAG,IAAb;AACA,QAAI,kBAAkB9D,SAAtB,EAAiC;AAC/B,WAAKY,gBAAL,GAAwB,IAAxB;AACA,WAAKmD,gBAAL,CAAsB,KAAKpD,MAA3B;AACA,UAAMqD,QAAQ,GAAG;AACfC,QAAAA,IAAI,EAAE,KAAKA,IAAL,CAAUC,IAAV,CAAeJ,IAAf,CADS;AAEfJ,QAAAA,KAAK,EAAE,KAAKA,KAAL,CAAWQ,IAAX,CAAgBJ,IAAhB,CAFQ;AAGfK,QAAAA,WAAW,EAAE,KAAKrC,UAAL,CAAgBoC,IAAhB,CAAqBJ,IAArB,CAHE;AAIfM,QAAAA,YAAY,EAAE,MAAM,KAAKtC,UAAL,CAAgB;AAAEC,UAAAA,OAAO,EAAE;AAAX,SAAhB,CAJL;AAKfsC,QAAAA,MAAM,EAAE,KAAK9B,IAAL,CAAU2B,IAAV,CAAeJ,IAAf;AALO,OAAjB;AAOAjP,MAAAA,MAAM,CAACE,IAAP,CAAYiP,QAAZ,EAAsBhP,OAAtB,CAA8BuD,GAAG,IAAI;AACnCyH,QAAAA,SAAS,CAACsE,YAAV,CAAuBC,gBAAvB,CAAwChM,GAAxC,EAA6CyL,QAAQ,CAACzL,GAAD,CAArD;AAED,OAHD;AAID;AACF;AAEDwL,EAAAA,gBAAgB,CAACzR,KAAD,EAAQ;AAEtB,QAAMkS,OAAO,GAAGlS,KAAK,CAACQ,KAAN,GAAc,CAAC;AAAEE,MAAAA,GAAG,EAAEV,KAAK,CAACQ,KAAb;AAAoB2R,MAAAA,KAAK,EAAE;AAA3B,KAAD,CAAd,GAAwDlD,SAAxE;AACAvB,IAAAA,SAAS,CAACsE,YAAV,CAAuBI,QAAvB,GAAkC,IAAIC,aAAJ,CAAkB;AAClDjS,MAAAA,KAAK,EAAEJ,KAAK,CAACI,KADqC;AAElDC,MAAAA,MAAM,EAAEL,KAAK,CAACK,MAFoC;AAGlDM,MAAAA,KAAK,EAAEX,KAAK,CAACW,KAHqC;AAIlDuR,MAAAA;AAJkD,KAAlB,CAAlC;AAMD;AAEDjF,EAAAA,EAAE,CAAC7G,IAAD,EAAO8G,QAAP,EAAiB;AACjB,SAAKF,MAAL,CAAYC,EAAZ,CAAe7G,IAAf,EAAqB8G,QAArB;AACD;AAEDyE,EAAAA,IAAI,GAAG;AACL,QAAI,CAAC,KAAK3R,KAAL,CAAWmR,MAAhB,EAAwB;AACxB,QAAMmB,OAAO,GAAG,KAAKtS,KAAL,CAAW2R,IAAX,EAAhB;AACA,QAAIW,OAAO,YAAYnO,OAAvB,EAAgC;AAC9BmO,MAAAA,OAAO,CAACC,IAAR,CAAa,MAAM;AACjB,aAAKhB,gBAAL;AACD,OAFD;AAGAe,MAAAA,OAAO,CAACE,KAAR,CAAerL,CAAD,IAAO;AACnB,YAAIA,CAAC,CAACf,IAAF,KAAW,iBAAX,IAAgCe,CAAC,CAACf,IAAF,KAAW,mBAA/C,EAAoE;AAClE,eAAKgL,KAAL;AACD;AACF,OAJD;AAKD,KATD,MASO;AACL,WAAKG,gBAAL;AACD;AACF;AAEDH,EAAAA,KAAK,GAAG;AACN,QAAI,KAAKpR,KAAL,CAAWmR,MAAf,EAAuB;AACvB,SAAKnR,KAAL,CAAWoR,KAAX;AACD;AAED7B,EAAAA,MAAM,GAAG;AACP,SAAKvP,KAAL,CAAWmR,MAAX,GAAoB,KAAKQ,IAAL,EAApB,GAAkC,KAAKP,KAAL,EAAlC;AACD;AAEDnB,EAAAA,IAAI,CAACpP,IAAD,EAAO;AACT,QAAI,CAAC,KAAKiO,QAAV,EAAoB;AACpBjO,IAAAA,IAAI,GAAG4R,QAAQ,CAAC5R,IAAD,CAAf;AACA,QAAIyC,KAAK,CAACzC,IAAD,CAAT,EAAiB;AACfwM,MAAAA,OAAO,CAACC,KAAR,CAAc,+BAAd;AACD;AACDzM,IAAAA,IAAI,GAAGC,IAAI,CAACI,GAAL,CAASL,IAAT,EAAe,KAAKP,QAApB,CAAP;AACAO,IAAAA,IAAI,GAAGC,IAAI,CAAC+K,GAAL,CAAShL,IAAT,EAAe,CAAf,CAAP;AACA,SAAKgO,EAAL,CAAQ7C,WAAR,CAAoBnL,IAApB,EAA0B,IAA1B,EAAgC,KAAKP,QAArC;AACA,QAAI,CAAC,KAAKkO,QAAV,EAAoB;AAClB,WAAKD,SAAL,GAAiB1N,IAAjB;AACD,KAFD,MAEO;AACL,WAAKb,KAAL,CAAW8J,WAAX,GAAyBjJ,IAAzB;AACD;AACF;AAED2O,EAAAA,UAAU,GAAqC;AAAA,QAApC;AAAE3O,MAAAA,IAAI,GAAG,EAAT;AAAa4O,MAAAA,OAAO,GAAG;AAAvB,KAAoC,uEAAJ,EAAI;AAC7C,QAAM3F,WAAW,GAAG,KAAK0E,QAAL,GAAgB,KAAKxO,KAAL,CAAW8J,WAA3B,GAAyC,KAAKyE,SAAlE;AACA,QAAMqB,UAAU,GAAG9F,WAAW,GAAGjJ,IAAI,IAAI4O,OAAO,GAAG,CAAH,GAAO,CAAC,CAAnB,CAArC;AACA,SAAKQ,IAAL,CAAUL,UAAV;AACD;AAEDqB,EAAAA,MAAM,CAACjR,KAAD,EAAQ;AACZ,QAAIA,KAAK,IAAIA,KAAK,CAACU,GAAnB,EAAwB;AACtB,WAAK2N,MAAL,GAAc1K,WAAW,CAAC3D,KAAD,CAAzB;AACA,WAAKwO,QAAL,GAAgB,KAAhB;AAEA,WAAKxO,KAAL,CAAWU,GAAX,GAAiB,KAAK2N,MAAL,CAAY3N,GAA7B;AACA,WAAKgS,eAAL,CAAqB,KAAKrE,MAA1B;AACA,WAAKrB,MAAL,CAAYG,OAAZ,CAAoB,aAApB,EAAmC,KAAKkB,MAAxC;AACA,UAAI,KAAKhM,OAAL,CAAahD,MAAb,KACD,CAACW,KAAK,CAACI,KAAP,IACD,CAACJ,KAAK,CAACK,MADN,IAED,CAACL,KAAK,CAACQ,KAFN,IAGD,CAACR,KAAK,CAACS,QAJL,CAAJ,EAKE;AACAqD,QAAAA,UAAU,CAACvB,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBxC,KAAlB,CAAD,EAA2B,KAAKqC,OAAL,CAAahD,MAAxC,CAAV,CAA0DkT,IAA1D,CAA+D1O,SAAS,IAAI;AAC1E,eAAKwK,MAAL,GAAcxK,SAAS,IAAI,KAAKwK,MAAhC;AACA,eAAKqE,eAAL,CAAqB,KAAKrE,MAA1B;AACA,eAAKrB,MAAL,CAAYG,OAAZ,CAAoB,YAApB,EAAkC,KAAKkB,MAAvC;AACD,SAJD;AAKD;AACF,KAnBD,MAmBO;AACL,YAAM,IAAIsE,KAAJ,CAAU,yCAAV,CAAN;AACD;AACF;AAEDD,EAAAA,eAAe,CAAC1S,KAAD,EAAQ;AACrB,SAAKA,KAAL,CAAWI,KAAX,GAAmBJ,KAAK,CAACI,KAAzB;AACA,SAAKyO,EAAL,CAAQ7D,YAAR,CAAqBhL,KAArB;AACA,SAAK8O,QAAL,GAAgB9O,KAAK,CAACM,QAAtB;AACA,QAAI,KAAKgO,gBAAT,EAA2B;AACzB,WAAKmD,gBAAL,CAAsBzR,KAAtB;AACD;AACF;AAED4S,EAAAA,YAAY,GAAG;AACb,SAAK5S,KAAL,CAAWoR,KAAX;AACA,SAAKpR,KAAL,CAAWU,GAAX,GAAiB,EAAjB;AACA,SAAKV,KAAL,CAAW6S,IAAX;AACA,SAAK7S,KAAL,GAAa,IAAb;AACD;AAED4M,EAAAA,OAAO,GAAG;AACR,SAAKgG,YAAL;AACA,SAAK/D,EAAL,CAAQjC,OAAR;AACArK,IAAAA,MAAM,CAACE,IAAP,CAAY,KAAK2L,KAAjB,EAAwB1L,OAAxB,CAAgCC,CAAC,IAAI;AACnC,UAAI,KAAKyL,KAAL,CAAWzL,CAAX,EAAciK,OAAd,IACF,OAAO,KAAKwB,KAAL,CAAWzL,CAAX,EAAciK,OAArB,KAAiC,UADnC,EAC+C;AAC7C,aAAKwB,KAAL,CAAWzL,CAAX,EAAciK,OAAd;AACD;AACF,KALD;AAMA,SAAKwB,KAAL,GAAa,IAAb;AACA,SAAK/L,OAAL,CAAanD,SAAb,CAAuBgH,SAAvB,GAAmC,EAAnC;AACD;AAEDwI,EAAAA,gBAAgB,GAAG;AACjB,QAAI,CAAClB,gBAAgB,CAACjK,MAAtB,EAA8B;AAC9BiK,IAAAA,gBAAgB,CAAC9K,OAAjB,CAAyBoQ,IAAI,IAAI;AAC/B,WAAK1E,KAAL,CAAW0E,IAAI,CAACC,KAAhB,IAAyB,IAAID,IAAJ,CAAS,IAAT,CAAzB;AACD,KAFD;AAGD;AAjXU;AAoXb3E,MAAM,CAAC6E,GAAP,GAAa,UAAUF,IAAV,EAAgB;AAC3BtF,EAAAA,gBAAgB,CAACtK,IAAjB,CAAsB4P,IAAtB;AACD,CAFD,CC7YAzF,WAAA,wHAAA,iDAAA,mBAAA;"}